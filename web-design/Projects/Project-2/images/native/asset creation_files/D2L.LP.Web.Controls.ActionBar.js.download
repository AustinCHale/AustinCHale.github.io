D2L.Control.ActionBar=D2L.Control.extend({Construct:function(){arguments.callee.$.Construct.call(this);this.m_isVisible=true;},IntegrateControlMin:function(deserializer){arguments.callee.$.IntegrateControlMin.call(this,deserializer);var cellIndex=0;var childIndex=-1;var children=deserializer.GetObjectArrayMin(D2L.Control.ActionBarItem);for(var i=0;i<children.length;i++){var domNode=null;childIndex++;if(this.GetDomNode().firstChild.firstChild.tagName.toLowerCase()=='ul'){if(i<this.GetDomNode().firstChild.firstChild.childNodes.length){domNode=this.GetDomNode().firstChild.firstChild.childNodes[i].firstChild;}else{domNode=this.GetDomNode().firstChild.childNodes[1].childNodes[i-this.GetDomNode().firstChild.firstChild.childNodes.length].firstChild;}}else{var row=this.GetDomNode().firstChild.firstChild.rows[0];while(cellIndex<3){if(row.cells[cellIndex].childNodes.length>0&&childIndex<row.cells[cellIndex].firstChild.rows[0].cells.length){domNode=row.cells[cellIndex].firstChild.rows[0].cells[childIndex].firstChild;if(domNode.className&&domNode.className.indexOf('dab_i')>-1){break;}else{domNode=null;}}cellIndex++;childIndex=0;}}children[i].IntegrateChild(this,domNode);}this.UpdateVisibility();},GetItem:function(key){for(var i=0;i<this.Children().length;i++){if(this.Children()[i].GetKey()==key){return this.Children()[i];}}return null;},Hide:function(){this.SetIsVisible(false);},IsVisible:function(){return this.m_isVisible;},SetIsVisible:function(isVisible){this.m_isVisible=isVisible;this.UpdateVisibility();},Show:function(){this.SetIsVisible(true);},UpdateVisibility:function(){if(this.IDomNode){var visibleChildren=false;for(var i=0;i<this.Children().length;i++){if(this.Children()[i].IsVisible()){visibleChildren=true;break;}}if(!visibleChildren||!this.IsVisible()){this.IDomNode.style.display='none';}else if(visibleChildren&&this.IsVisible()){this.IDomNode.style.display='block';}}}});D2L.Control.ActionBarItem=D2L.Control.extend({Construct:function(){arguments.callee.$.Construct.call(this);this.m_isVisible=true;this.m_key='';this.m_text='';this.m_domImg=null;this.m_domText=null;this.m_anchor=null;this.m_navInfo=null;this.m_hasLink=false;},DeserializeMin:function(deserializer){this.m_key=deserializer.GetMember();this.m_text=deserializer.GetMember();this.m_isVisible=deserializer.GetBoolean();this.m_hasLink=deserializer.GetBoolean();},IntegrateChild:function(parent,domNode){arguments.callee.$.IntegrateChild.call(this,parent,domNode);this.m_domImg=this.IDomNode.firstChild.childNodes[0];this.m_domText=this.IDomNode.firstChild.childNodes[1];this.m_separator=this.IDomNode.parentNode;this.m_anchor=this.IDomNode.firstChild;},GetKey:function(){return this.m_key;},GetText:function(){return this.m_text;},Hide:function(){this.SetIsVisible(false);},IsVisible:function(){return this.m_isVisible;},SetDescription:function(description){description=D2L.LP.Text.IText.Normalize(description,'D2L.Control.ActionBarItem','SetDescription','description');if(this.m_anchor){description.AssignText(this.m_anchor,'title');}},SetImage:function(imageTerm){if(this.m_domImg){imageTerm.Assign(this.m_domImg);}},SetIsVisible:function(isVisible){if(this.IDomNode){this.IDomNode.style.display=isVisible?'inline':'none';}this.m_isVisible=isVisible;var firstVisibleItem=null;if(this.Parent()){for(var i=0;i<this.Parent().Children().length;i++){var child=this.Parent().Children()[i];if(firstVisibleItem===null&&child.IsVisible()){firstVisibleItem=child;child.IDomNode.className='dab_i';}else if(child.IsVisible()){child.IDomNode.className='dab_i dab_s';}else{child.IDomNode.className='dab_i';}}}if(this.Parent()){this.Parent().UpdateVisibility();}},SetOnClick:function(onClick){UI.GetMessageArea().AddWarningMessage(new D2L.LP.Text.PlainText('ActionBarItem.SetOnClick() is '+'obsolete. Please use SetNav() instead.'),true);if(onClick){if(this.m_navInfo==null){this.m_navInfo=new D2L.NavInfo();}this.m_navInfo.SetOnClick(onClick);this.SetNav(this.m_navInfo);}},SetNav:function(navInfo){if(navInfo){this.m_navInfo=navInfo;if(!this.m_hasLink){this.m_hasLink=true;}var navStruct=this.m_navInfo.SetupHrefOnClick(this);this.m_anchor.href=navStruct.Href;if(navStruct.Target==null||navStruct.Target==''){if(this.m_anchor.attributes.getNamedItem('target')){this.m_anchor.attributes.removeNamedItem('target');}}else{this.m_anchor.target=navStruct.Target;}var me=this;if(navStruct.OnClick){var me=this;this.AttachObject(this.m_anchor,'onclick',function(){if(navStruct.OnClick){return navStruct.OnClick.call();}});}}},SetText:function(text){this.m_text=D2L.LP.Text.IText.Normalize(text,'D2L.Control.ActionBarItem','SetText','text');if(this.m_domText){if(this.m_domText.firstChild){D2L.Util.Dom.Purge(this.m_domText.firstChild);this.m_domText.removeChild(this.m_domText.firstChild);}this.m_domText.appendChild(this.CreateTextNode(this.m_text));}},Show:function(){this.SetIsVisible(true);}});D2L.ActionBar=D2L.Control.ActionBar;D2L.ActionBarItem=D2L.Control.ActionBarItem;