D2L.Control.DataList=D2L.Control.extend({Construct:function(){arguments.callee.$.Construct.call(this);this.m_addItemsEvent=new D2L.EventHandler();this.m_clickItemEvent=new D2L.EventHandler();this.m_controlRenderer=null;this.m_deleteItemsEvent=new D2L.EventHandler();this.m_dragDropInfo=null;this.m_dragDropMode=D2L.DragDrop.Modes.None;this.m_entitySourceRpc='';this.m_entitySourceRpcSrc='';this.m_isDataLoadDelayed=false;this.m_isDelayedDataLoadComplete=false;this.m_isItemClickEnabled=false;this.m_isLayoutToggleDisplayed=true;this.m_isPagingDisplayed=true;this.m_isReloading=false;this.m_items=[];this.m_itemRenderer=new D2L.Control.DataList.ItemRenderer();this.m_itemsRenderedEvent=new D2L.EventHandler();this.m_loadEvent=new D2L.EventHandler();this.m_layoutTypeChangedEvent=new D2L.EventHandler();this.m_layoutType=D2L.Control.DataList.LayoutTypes.List;this.m_restrictReload=false;this.m_style=D2L.Control.DataList.Styles.Default;this.m_mouseOutItemEvent=new D2L.EventHandler();this.m_mouseOverItemEvent=new D2L.EventHandler();this.m_paging=null;this.m_pagingType=D2L.Control.DataList.PagingTypes.Numeric;this.m_parameters=new D2L.Util.Dictionary();this.m_reloadBeginEvent=new D2L.EventHandler();this.m_reloadResponseEvent=new D2L.EventHandler();this.m_reloadEndEvent=new D2L.EventHandler();this.m_selectionControl=D2L.Control.DataList.SelectionControls.Input;this.m_selectionMode=D2L.Control.DataList.SelectionModes.None;this.m_selectedItem=null;this.m_selectItemEvent=new D2L.EventHandler();this.m_sortEvent=new D2L.EventHandler();this.m_sorting=null;this.m_summary='';this.m_unSelectItemEvent=new D2L.EventHandler();},AddItem:function(item){this.AddItems([item]);},AddItems:function(items,doTriggerAddEvent){D2L.LP.Web.UI.Html.JavaScript.Console.Debug('DataList.AddItems');if(doTriggerAddEvent===undefined){doTriggerAddEvent=true;}for(var i=0;i<items.length;i++){items[i].Init(this);this.m_items.push(items[i]);if(items[i].IsSelected()&&this.m_selectionMode==D2L.Control.DataList.SelectionModes.Single){this.m_selectedItem=this.m_items[this.m_items.length-1];}}this.m_controlRenderer.RenderItems(items);if(doTriggerAddEvent){this.AddItemsEvent().Trigger(items);}},AddItemsEvent:function(){return this.m_addItemsEvent;},ClearList:function(){this.DeleteItems(this.m_items,false);},ClickItemEvent:function(){if(this.m_isItemClickEnabled){return this.m_clickItemEvent;}else{UI.GetMessageArea().AddWarningMessage(new D2L.LP.Text.PlainText('ClickItemEvent model is disabled '+'on this instance of the DataList.'),true);return null;}},DeleteItem:function(item,doTriggerDeleteEvent){if(doTriggerDeleteEvent===undefined){doTriggerDeleteEvent=true;}var index=-1;for(var i=0;i<this.m_items.length;i++){if(this.m_items[i]==item){index=i;break;}}this.m_items.splice(index,1);if(item.IsSelected()&&this.m_selectionMode==D2L.Control.DataList.SelectionModes.Single&&this.m_selectedItem==item){this.m_selectedItem=null;}this.m_controlRenderer.RemoveItem(item);if(doTriggerDeleteEvent){this.DeleteItemsEvent().Trigger([item]);}},DeleteItems:function(items,doTriggerDeleteEvent){D2L.LP.Web.UI.Html.JavaScript.Console.Debug('DataList.DeleteItems');if(doTriggerDeleteEvent===undefined){doTriggerDeleteEvent=true;}var dItems=[];for(var i=items.length-1;i>-1;i--){dItems.push(items[i]);this.DeleteItem(items[i],false);}if(doTriggerDeleteEvent){this.DeleteItemsEvent().Trigger(dItems);}},DeleteItemsEvent:function(){return this.m_deleteItemsEvent;},GetDragDropInfo:function(){return this.m_dragDropInfo;},GetDragDropMode:function(){return this.m_dragDropMode;},GetItemRenderer:function(){return this.m_itemRenderer;},GetItem:function(itemKey){for(var i=0;i<this.m_items.length;i++){if(this.m_items[i].GetKey()==itemKey){return this.m_items[i];}}return null;},GetItems:function(){return this.m_items;},GetItemsNode:function(){return this.m_controlRenderer.GetItemsNode();},GetItemCount:function(){return this.m_items.length;},GetLayoutType:function(){return this.m_layoutType;},GetStyle:function(){return this.m_style;},GetPaging:function(){return this.m_paging;},GetPagingType:function(){return this.m_pagingType;},GetParameter:function(name){return this.m_parameters.Get(name);},GetParameters:function(){return this.m_parameters;},GetSelectionControl:function(){return this.m_selectionControl;},GetSelectionMode:function(){return this.m_selectionMode;},GetSelectedItem:function(){if(this.m_selectionMode==D2L.Control.DataList.SelectionModes.None||this.m_selectionMode==D2L.Control.DataList.SelectionModes.Multiple){return null;}else{return this.m_selectedItem;}},GetSelectedItemCount:function(){var itemCount=0;if(this.m_selectionMode!=D2L.Control.DataList.SelectionModes.None){if(this.m_selectionMode==D2L.Control.DataList.SelectionModes.Single){if(this.m_selectedItem!=null){itemCount=1;}}else{for(var i=0;i<this.m_items.length;i++){if(this.m_items[i].IsSelected()){itemCount+=1;}}}}return itemCount;},GetSelectedItems:function(){var items=[];if(this.m_selectionMode==D2L.Control.DataList.SelectionModes.Single){if(this.m_selectedItem!=null){items.push(this.m_selectedItem);}}else if(this.m_selectionMode==D2L.Control.DataList.SelectionModes.Multiple){for(var i=0;i<this.m_items.length;i++){if(this.m_items[i].IsSelected()){items.push(this.m_items[i]);}}}return items;},GetSortingInfo:function(){return this.m_sorting;},GetSummary:function(){return this.m_summary;},InstallEvents:function(){var me=this;var paging=this.m_paging;if(this.m_pagingType==D2L.Control.DataList.PagingTypes.Numeric){paging.PageNumberChangeEvent().RegisterMethod(function(pageNumber){me.Reload();});paging.PageSizeChangeEvent().RegisterMethod(function(pageSize){me.Reload();});}},IntegrateControl:function(deserializer){arguments.callee.$.IntegrateControl.call(this);this.m_entitySourceRpc=deserializer.GetMember('EntitySourceRpc');this.m_entitySourceRpcSrc=deserializer.GetMember('EntitySourceRpcSrc');this.m_summary=deserializer.GetObject('Summary');this.m_isItemClickEnabled=deserializer.GetMember('IsItemClickEnabled');this.m_isDataLoadDelayed=deserializer.GetMember('IsDataLoadDelayed');this.m_selectionMode=deserializer.GetMember('SelectionMode');this.m_selectionControl=deserializer.GetMember('SelectionControlType');this.m_isLayoutToggleDisplayed=deserializer.GetMember('IsLayoutToggleDisplayed');this.m_layoutType=deserializer.GetMember('LayoutType');this.m_restrictReload=deserializer.GetMember('RestrictReload');this.m_style=deserializer.GetMember('DataListStyle');this.m_sorting=deserializer.GetObjectArray('Sorting',D2L.LP.LayeredArch.SortingInfo);var itemRendererJsClass=deserializer.GetMemberAsFunction('ItemRendererJsClass');this.m_itemRenderer=deserializer.GetObject('ItemRenderer',itemRendererJsClass);this.m_itemRenderer.Init(this);var rpcResponse=deserializer.GetObject('RpcResponse',D2L.Control.DataList.RpcResponse);this.m_items=rpcResponse.GetItems();for(var i=0;i<this.m_items.length;i++){this.m_items[i].Init(this);if(this.m_items[i].IsSelected()&&this.m_selectionMode==D2L.Control.DataList.SelectionModes.None){this.m_selectedItem=this.m_items[i];}}var parameters=deserializer.GetDictionary('Parameters');for(var key in parameters){this.m_parameters.Add(key,parameters[key]);}this.m_isPagingDisplayed=deserializer.GetMember('IsPagingDisplayed');this.m_pagingType=deserializer.GetMember('PagingType');var pageSize=deserializer.GetMember('PagingSize');var pageSizeLimit=deserializer.GetMember('PageSizeLimit');if(this.m_pagingType!==D2L.Control.DataList.PagingTypes.None){this.m_paging=new D2L.Control.Paging();this.m_paging.SetPageSize(pageSize);this.m_paging.SetPageSizeLimit(pageSizeLimit);this.m_paging.SetTotalObjectCount(rpcResponse.GetTotalEntityCount());}this.m_dragDropMode=deserializer.GetMember('DragDropMode');if(deserializer.HasMember('DragDropSettingsControlID')){var dragDropSettingsControlId=deserializer.GetObject('DragDropSettingsControlID',D2L.Control.Id);this.m_dragDropInfo=UI.GetControl(dragDropSettingsControlId.ID(),dragDropSettingsControlId.SID()).GetDragDropInfo();}this.m_isDelayedDataLoadComplete=!this.m_isDataLoadDelayed;this.m_controlRenderer=new D2L.Control.DataList.Renderer(this);this.m_controlRenderer.RenderItems(this.m_items);if(D2L.Util.Aria.IsEnabled()){var ariaController=new D2L.Control.DataList.AriaController(this);}this.InstallEvents();this.LoadEvent().Trigger();},InvokeRpc:function(keepSessionAlive){var dr=new D2L.Util.DelayedReturn();var me=this;if(keepSessionAlive===undefined){keepSessionAlive=true;}var rpcCallback=function(rpcResponse){if(rpcResponse.GetType()==D2L.Rpc.ResponseType.Success){dr.Trigger(rpcResponse.GetResult(D2L.Control.DataList.RpcResponse));}else{UI.Error(new D2L.LP.Text.LangTerm(D2L.Control.DataList.LANG_ERR_DATA_RETRIEVAL_PRIMARY),new D2L.LP.Text.LangTerm(D2L.Control.DataList.LANG_ERR_DATA_RETRIEVAL_SECONDARY),me);}};var rpcRequest=new D2L.Control.DataList.RpcRequest();rpcRequest.SetRpc(this.m_entitySourceRpc);rpcRequest.SetRpcSrc(this.m_entitySourceRpcSrc);rpcRequest.SetSorting(this.m_sorting);if(this.GetPagingType()!==D2L.Control.DataList.PagingTypes.None){rpcRequest.SetPaging(new D2L.LP.LayeredArch.PagingInfo(this.m_paging.GetPageSize(),this.m_paging.GetPageNumber()));}rpcRequest.SetParameters(this.m_parameters);setTimeout(function(){var rpc=D2L.Rpc.Create('Reload',rpcCallback,'/d2l/common/rpc/dataList/dataList.d2l');rpc.SetSessionKeepAlive(keepSessionAlive);rpc.Call(rpcRequest);},0);return dr;},IsEmpty:function(){return this.m_items.length===0;},IsItemClickEnabled:function(){return this.m_isItemClickEnabled;},IsDataLoadDelayed:function(){return this.m_isDataLoadDelayed;},IsLayoutToggleDisplayed:function(){return this.m_isLayoutToggleDisplayed;},IsPagingDisplayed:function(){return this.m_isPagingDisplayed;},IsReloading:function(){return this.m_isReloading;},IsChangeSelectionAllowed:function(item){if(this.m_selectionMode>D2L.Control.DataList.SelectionModes.None&&item!=null&&item.IsEnabled()){if(this.m_selectionMode==D2L.Control.DataList.SelectionModes.Single){return this.m_selectedItem==null||this.m_selectedItem.IsEnabled();}else{return true;}}else{return false;}},ItemsRenderedEvent:function(items){return this.m_itemsRenderedEvent;},LayoutTypeChangedEvent:function(){return this.m_layoutTypeChangedEvent;},LoadEvent:function(){return this.m_loadEvent;},MoveItem:function(item,index){if(this.m_items.length>1&&item!=null&&index!=null){index=parseInt(index);if(!isNaN(index)&&this.m_items.length>index){var newItemIndex=-1;var items=[];for(var i=0;i<this.m_items.length;i++){if(this.m_items[i]!=item){newItemIndex+=1;if(newItemIndex==index){newItemIndex+=1;items.push(item);}items.push(this.m_items[i]);}}if(index==this.m_items.length-1){items.push(item);}this.m_items=items;if(index<this.m_items.length-1){this.m_controlRenderer.MoveItemBefore(item,this.m_items[index+1]);}else{this.m_controlRenderer.MoveItemBefore(item);}}}},MouseOutItemEvent:function(){return this.m_mouseOutItemEvent;},MouseOverItemEvent:function(){return this.m_mouseOverItemEvent;},Reload:function(keepSessionAlive){if(this.m_isReloading&&this.m_restrictReload){return;}this.m_isReloading=true;this.ReloadBeginEvent().Trigger(this);var me=this;this.InvokeRpc(keepSessionAlive).Register(function(rpcResponse){me.ReloadResponseEvent().Trigger(rpcResponse);me.m_parameters=rpcResponse.GetParameters();me.DeleteItems(me.m_items,false);me.AddItems(rpcResponse.GetItems(),false);if(me.m_paging!==null){me.m_paging.SetTotalObjectCount(rpcResponse.GetTotalEntityCount());}me.m_isReloading=false;me.m_isDelayedDataLoadComplete=true;me.ReloadEndEvent().Trigger(me,rpcResponse.GetErrorMessages());});},ReloadBeginEvent:function(){return this.m_reloadBeginEvent;},ReloadEndEvent:function(){return this.m_reloadEndEvent;},ReloadResponseEvent:function(){return this.m_reloadResponseEvent;},RemoveParameter:function(name){this.m_parameters.Remove(name);},SelectItemEvent:function(){return this.m_selectItemEvent;},SelectItem:function(item,doTriggerSelectEvent){if(doTriggerSelectEvent===undefined){doTriggerSelectEvent=true;}if(this.m_selectionMode==D2L.Control.DataList.SelectionModes.Single){if(this.m_selectedItem!=null&&this.m_selectedItem!=item){this.m_selectedItem.SetIsSelected(false);}this.m_selectedItem=item;}else{this.m_selectedItem=null;}if(doTriggerSelectEvent){this.SelectItemEvent().Trigger(item);}},SetSelectedItem:function(item){if(item!=null){item.SetIsSelected(true);}else{item=this.m_selectedItem;if(item!=null){item.SetIsSelected(false);}}},SetSortingInfo:function(sortingInfo){if(this.m_sorting!==sortingInfo){this.m_sorting=sortingInfo;this.m_sortEvent.Trigger();this.Reload();}},SetLayoutType:function(layoutType){if(layoutType!=D2L.Control.DataList.LayoutTypes.Tiles){layoutType=D2L.Control.DataList.LayoutTypes.List;}if(this.m_layoutType!=layoutType){this.m_layoutType=layoutType;this.m_layoutTypeChangedEvent.Trigger(layoutType);}},SetParameter:function(name,value){this.m_parameters.Add(name,value);},SetSummary:function(summary){this.m_summary=summary;if(this.m_controlRenderer!=null){this.m_controlRenderer.SetSummary(summary);}},SortEvent:function(){return this.m_sortEvent;},UnSelectItem:function(item,doTriggerUnSelectEvent){if(doTriggerUnSelectEvent===undefined){doTriggerUnSelectEvent=true;}if(this.m_selectedItem==item){this.m_selectedItem=null;}if(doTriggerUnSelectEvent){this.UnSelectItemEvent().Trigger(item);}},UnSelectItemEvent:function(){return this.m_unSelectItemEvent;}});D2L.Control.DataList.DefaultDragGhostRenderer=function(){var ghost=UI.CreateElement('ul');ghost.className='ddl_sc';return ghost;};D2L.Control.DataList.DragDropSelectionState=[];D2L.Control.DataList.HandleStartDrag=function(drag){var item=drag.GetControl();var dataList=item.GetDataList();var ghost=drag.GetCustomGhostControl();ghost.innerHTML='';if(dataList.GetLayoutType()==D2L.Control.DataList.LayoutTypes.List){ghost.style.width=dataList.GetDomNode().offsetWidth+"px";}if(dataList.GetSelectionMode()!=D2L.Control.DataList.SelectionModes.None){D2L.Control.DataList.DragDropSelectionState=[];var selectedItems=dataList.GetSelectedItems();for(var i=0;i<selectedItems.length;i++){D2L.Control.DataList.DragDropSelectionState.push(selectedItems[i]);if(!item.IsSelected()&&selectedItems[i]!=item){selectedItems[i].SetIsSelected(false);}}item.SetIsSelected(true);var selectedItems=dataList.GetSelectedItems();for(var i=0;i<selectedItems.length;i++){var item=selectedItems[i];var clone=item.GetNode().cloneNode(true);ghost.appendChild(clone);}}else{var clone=item.GetNode().cloneNode(true);ghost.style.width=item.GetNode().offsetWidth+'px';ghost.appendChild(clone);}};D2L.Control.DataList.HandleEndDrag=function(drag){var item=drag.GetControl();var dataList=item.GetDataList();if(dataList.GetSelectionMode()!=D2L.Control.DataList.SelectionModes.None){var selectedItems=dataList.GetSelectedItems();if(drag.GetDropIsValid()){for(var i=0;i<selectedItems.length;i++){selectedItems[i].SetIsSelected(false);}}else{var itemWasOriginallyChecked=false;for(var i=0;i<D2L.Control.DataList.DragDropSelectionState.length;i++){var itemState=D2L.Control.DataList.DragDropSelectionState[i];itemState.SetIsSelected(true);if(itemState==item){itemWasOriginallyChecked=true;}}if(!itemWasOriginallyChecked){item.SetIsSelected(false);}}}};D2L.Control.DataList.AriaLoggingIsEnabled=true;D2L.Control.DataList.AriaController=D2L.Class.extend({Construct:function(dataList){arguments.callee.$.Construct.call(this);this.m_dataList=dataList;this.Init();},AddAriaMessage:function(message){if(D2L.Control.DataList.AriaLoggingIsEnabled){this.m_dataList.GetUI().GetMessageArea().AddAriaMessage(message);}},GetItemsNode:function(){if(this.m_dataList!=null&&this.m_dataList.m_controlRenderer!=null){return this.m_dataList.m_controlRenderer.GetItemsNode();}return null;},Init:function(){var me=this;this.m_dataList.LoadEvent().RegisterMethod(function(){me.OnLoad();me.RenderItems(me.m_dataList.GetItems());});this.m_dataList.ItemsRenderedEvent().RegisterMethod(function(items){me.RenderItems(items);});this.m_dataList.SelectItemEvent().RegisterMethod(function(item){if(!me.m_dataList.IsItemClickEnabled()&&me.m_dataList.GetSelectionControl()==D2L.Control.DataList.SelectionControls.Item){var msg='Framework.DataList.lblItemSelected';me.AddAriaMessage(new D2L.LP.Text.LangTerm(msg));}var items=[];items.push(item);me.RenderItems(items);});this.m_dataList.UnSelectItemEvent().RegisterMethod(function(item){var items=[];items.push(item);me.RenderItems(items);});var isSorting=false;this.m_dataList.ReloadBeginEvent().RegisterMethod(function(){var msg=isSorting?'Framework.DataList.altApplyingSort':'Framework.DataList.altLoading';me.AddAriaMessage(new D2L.LP.Text.LangTerm(msg));});this.m_dataList.ReloadResponseEvent().RegisterMethod(function(){var itemsNode=me.GetItemsNode();if(itemsNode!=null){D2L.Util.Aria.SetAttribute(itemsNode,'busy','true');}});this.m_dataList.ReloadEndEvent().RegisterMethod(function(){var itemCount=0;if(me.m_dataList.m_items!=null){itemCount=me.m_dataList.m_items.length;}var msg=isSorting?new D2L.LP.Text.LangTerm('Framework.DataList.altSortAppliedSuccessfully'):new D2L.LP.Text.LangTerm('Framework.DataList.altLoadedSuccessfully',D2L.Util.Integer.Format(itemCount));isSorting=false;me.AddAriaMessage(msg);var itemsNode=me.GetItemsNode();if(itemsNode!=null){D2L.Util.Aria.SetAttribute(itemsNode,'busy','false');}});this.m_dataList.SortEvent().RegisterMethod(function(){isSorting=true;});},OnLoad:function(){var itemsNode=this.GetItemsNode();if(itemsNode!=null){D2L.Util.Aria.SetAttribute(itemsNode,'live','polite');D2L.Util.Aria.SetAttribute(itemsNode,'relevant','additions');}},RenderItems:function(items){var me=this;if(!me.m_dataList.IsItemClickEnabled()&&me.m_dataList.GetSelectionControl()==D2L.Control.DataList.SelectionControls.Item){var role='';if(me.m_dataList.GetSelectionMode()==D2L.Control.DataList.SelectionModes.Multiple){role='checkbox';}else if(me.m_dataList.GetSelectionMode()==D2L.Control.DataList.SelectionModes.Single){role='radio';D2L.Util.Aria.SetRole(me.m_dataList.GetItemsNode(),'radiogroup');}for(var i=0;i<items.length;i++){D2L.Util.Aria.SetRole(items[i].GetAnchorNode(),role);if(items[i].IsSelected()){D2L.Util.Aria.SetAttribute(items[i].GetAnchorNode(),'checked',true);}else{D2L.Util.Aria.SetAttribute(items[i].GetAnchorNode(),'checked',false);}if(items[i].IsEnabled()){D2L.Util.Aria.SetAttribute(items[i].GetAnchorNode(),'disabled',false);}else{D2L.Util.Aria.SetAttribute(items[i].GetAnchorNode(),'disabled',true);}}}}});D2L.Control.DataList.Renderer=D2L.Class.extend({Construct:function(dataList){arguments.callee.$.Construct.call(this);this.m_actionContainer=null;this.m_dataList=dataList;this.m_emptyState=this.GetDomNode().querySelector('.ddl-empty-state');this.m_itemsNode=null;this.m_listItemWidthEm=0;this.m_listItemHeightEm=0;this.m_selectedMsg='';this.m_selectInstructionMsg='';this.m_summaryNode=null;this.m_tileItemHeightEm=0;this.m_tileItemWidthEm=0;this.m_unSelectedMsg='';this.Init();},BuildActionContainer:function(){var dataList=this.GetDataList();if(dataList.IsPagingDisplayed()&&dataList.GetPagingType()!=D2L.Control.DataList.PagingTypes.None||dataList.IsLayoutToggleDisplayed()){this.m_actionContainer=this.CreateElement('div');this.m_actionContainer.className='ddl_ac';if(dataList.IsLayoutToggleDisplayed()){var toggleContainer=this.CreateElement('div');toggleContainer.className='ddl_tc';this.m_actionContainer.appendChild(toggleContainer);var toggle=this.CreateLayoutToggle();toggle.AppendTo(toggleContainer);}if(dataList.GetPagingType()==D2L.Control.DataList.PagingTypes.Numeric){var pagingContainer=this.CreateElement('span');pagingContainer.className='ddl_pc';this.m_actionContainer.appendChild(pagingContainer);var paging=dataList.GetPaging();var pagingRenderer=new D2L.Control.Paging.NumericRenderer(paging);paging.AppendTo(pagingContainer);}var clear=this.CreateElement('div');clear.className='clear';this.m_actionContainer.appendChild(clear);this.GetDomNode().appendChild(this.m_actionContainer);}},BuildItemsContainer:function(){this.m_itemsNode=this.CreateElement('ul');this.m_itemsNode.id=this.GetDataList().GetMappedId()+'_c';this.m_itemsNode.className=this.GetItemsNodeClassName(this.GetDataList().GetLayoutType(),this.GetDataList().GetStyle());this.GetDomNode().appendChild(this.m_itemsNode);},CalculateItemHeight:function(baseFontSize,heightPx){return D2L.Style.Utility.PixelToEm(baseFontSize,heightPx);},CalculateItemWidth:function(baseFontSize,widthPx){var dataList=this.GetDataList();var widthEm=0;if(dataList.GetSelectionMode()!=D2L.Control.DataList.SelectionModes.None&&dataList.GetSelectionControl()==D2L.Control.DataList.SelectionControls.Input){widthEm=D2L.Style.Utility.PixelToEm(baseFontSize,widthPx-20);}else{widthEm=D2L.Style.Utility.PixelToEm(baseFontSize,widthPx);}return widthEm;},CreateElement:function(tag){return this.m_dataList.CreateElement(tag);},CreateLayoutToggle:function(){var me=this;var dataList=this.GetDataList();var layoutType=dataList.GetLayoutType();var toggle=new D2L.Control.Selector();toggle.SetSummary(new D2L.LP.Text.LangTerm('Framework.DataList.lblLayoutToggleSummary'));toggle.SetIsRequired(true);toggle.SetOrientation(D2L.Control.Selector.Orientation.Horizontal);toggle.SetSelectionMode(D2L.Control.Selector.SelectionModes.Single);var item=new D2L.Control.Selector.Item();item.SetKey(D2L.Control.DataList.LayoutTypes.List);item.SetTitle(new D2L.LP.Text.LangTerm('Framework.DataList.lblLayoutList'));item.SetImage(new D2L.Images.ImageTerm('Framework.DataList.actLayoutList'));toggle.AddItem(item);if(layoutType==D2L.Control.DataList.LayoutTypes.List){toggle.SetSelectedItem(item);}item.SelectEvent().RegisterMethod(function(){me.SelectListLayoutHandler();});item=new D2L.Control.Selector.Item();item.SetKey(D2L.Control.DataList.LayoutTypes.Tiles);item.SetTitle(new D2L.LP.Text.LangTerm('Framework.DataList.lblLayoutTiles'));item.SetImage(new D2L.Images.ImageTerm('Framework.DataList.actLayoutTiles'));toggle.AddItem(item);if(layoutType==D2L.Control.DataList.LayoutTypes.Tiles){toggle.SetSelectedItem(item);}item.SelectEvent().RegisterMethod(function(){me.SelectTilesLayoutHandler();});return toggle;},DisplayContentContainer:function(){if(this.GetDataList().GetItemCount()>0){if(this.m_actionContainer){this.m_actionContainer.removeAttribute('hidden');}this.m_itemsNode.removeAttribute('hidden');this.m_emptyState.setAttribute('hidden','hidden');}else{if(this.m_actionContainer){this.m_actionContainer.setAttribute('hidden','hidden');}this.m_itemsNode.setAttribute('hidden','hidden');this.m_emptyState.removeAttribute('hidden');}},GetDataList:function(){return this.m_dataList;},GetDomNode:function(){return this.m_dataList.GetDomNode();},GetItemsNode:function(){return this.m_itemsNode;},GetItemsNodeClassName:function(layoutType,style){var className='vui-list';if(layoutType===D2L.Control.DataList.LayoutTypes.Tiles){className+=' vui-no-separator ddl_fc';}else{className+=' ddl_sc';}if(style===D2L.Control.DataList.Styles.Normal){className+=' dnl';}return className;},Init:function(){this.RenderSummary();this.BuildActionContainer();this.BuildItemsContainer();var dataList=this.GetDataList();var me=this;dataList.LayoutTypeChangedEvent().RegisterMethod(function(layoutType){me.SetLayoutType(layoutType);});dataList.SelectItemEvent().RegisterMethod(function(item){me.RenderItemStyle(null,null,item);me.RenderItemText(item);});dataList.UnSelectItemEvent().RegisterMethod(function(item){me.RenderItemStyle(null,null,item);me.RenderItemText(item);});dataList.MouseOutItemEvent().RegisterMethod(function(item){me.RenderItemStyle(null,null,item);});dataList.AddItemsEvent().RegisterMethod(function(items){me.DisplayContentContainer();});dataList.DeleteItemsEvent().RegisterMethod(function(items){me.DisplayContentContainer();});dataList.LoadEvent().RegisterMethod(function(){me.DisplayContentContainer();});var shimHandle=null;dataList.ReloadBeginEvent().RegisterMethod(function(){if(shimHandle!=null){dataList.GetUI().GetShimController().ClearShim(shimHandle);}shimHandle=dataList.GetUI().GetShimController().Shim(dataList,true);});dataList.ReloadEndEvent().RegisterMethod(function(){dataList.GetUI().GetShimController().ClearShim(shimHandle);shimHandle=null;me.DisplayContentContainer();});this.m_selectedMsg=new D2L.LP.Text.LangTerm('Framework.DataList.lblItemIsSelected');this.m_unSelectedMsg=new D2L.LP.Text.LangTerm('Framework.DataList.lblItemIsNotSelected');var baseFontSize=UI.GetRelativeFontSizeManager().GetBaseFontSize();var renderer=dataList.GetItemRenderer();this.m_tileItemWidthEm=this.CalculateItemWidth(baseFontSize,renderer.GetTileItemWidth());this.m_tileItemHeightEm=this.CalculateItemHeight(baseFontSize,renderer.GetTileItemHeight());this.m_listItemWidthEm=this.CalculateItemWidth(baseFontSize,renderer.GetListItemWidth());this.m_listItemHeightEm=this.CalculateItemHeight(baseFontSize,renderer.GetListItemHeight());},InstallItemBlur:function(dataList,item,itemNode){item.AttachObject(itemNode,'onblur',function(){item.SetHasFocus(false);dataList.MouseOutItemEvent().Trigger(item);if(this.classList.contains('ddl_li_c')){item.GetNode().classList.remove('d2l-list-item-action-focus');}});},InstallItemClick:function(dataList,item,itemNode){item.AttachObject(itemNode,'onclick',function(){dataList.ClickItemEvent().Trigger(item);});itemNode.tabIndex=0;UI.GetWindowEventManager().InstallKpel(itemNode,function(obj,evt){if(evt.GetKey()==D2L.KeyPressEvent.Key.Enter){dataList.ClickItemEvent().Trigger(item);}});},InstallItemDragDrop:function(dataList,item,itemNode){var ddObject;var calculatedMode=item.GetDragDropMode();if(calculatedMode!=D2L.DragDrop.Modes.None){setTimeout(function(){if(calculatedMode==D2L.DragDrop.Modes.DraggableDroppable){ddObject=new D2L.DragDrop.DraggableDroppable(item,itemNode);itemNode.className=itemNode.className+' draggable';}if(calculatedMode==D2L.DragDrop.Modes.Draggable){ddObject=new D2L.DragDrop.Draggable(item,itemNode);itemNode.className=itemNode.className+' draggable';}if(calculatedMode==D2L.DragDrop.Modes.Droppable){ddObject=new D2L.DragDrop.Droppable(item,itemNode);}if(dataList.GetDragDropInfo()){D2L.DragDrop.SetDragDropInfo(ddObject,dataList.GetDragDropInfo());}ddObject.SetCustomGhostRenderer(D2L.Control.DataList.DefaultDragGhostRenderer);ddObject.OnStartDrag.RegisterMethod(function(){D2L.Control.DataList.HandleStartDrag(ddObject);});ddObject.OnEndDrag.RegisterMethod(function(){D2L.Control.DataList.HandleEndDrag(ddObject);});},0);}},InstallItemFocus:function(dataList,item,itemNode){item.AttachObject(itemNode,'onfocus',function(){item.SetHasFocus(true);dataList.MouseOverItemEvent().Trigger(item);if(this.classList.contains('ddl_li_c')){item.GetNode().classList.add('d2l-list-item-action-focus');}});},InstallItemMouseOver:function(dataList,item,itemNode){item.AttachObject(itemNode,'onmouseover',function(){dataList.MouseOverItemEvent().Trigger(item);this.classList.add('d2l-list-item-action-hover');});},InstallItemMouseOut:function(dataList,item,itemNode){item.AttachObject(itemNode,'onmouseout',function(){dataList.MouseOutItemEvent().Trigger(item);this.classList.remove('d2l-list-item-action-hover');});},InstallItemSelect:function(dataList,item,itemNode){if(UI.GetBrowserInfo().Type==D2L.UI.BrowserType.Firefox){item.AttachObject(itemNode,'onkeydown',function(evt){if(evt.keyCode==32){evt.preventDefault();}});}item.AttachObject(itemNode,'onclick',function(evt){D2L.Util.Dom.CancelBubble(evt);item.ToggleSelected();});},MoveItemBefore:function(item,beforeItem){if(this.m_itemsNode!=null&&item!=null&&item.GetNode()!=null){var itemNode=item.GetNode();if(beforeItem!=null&&beforeItem.GetNode()!=null){this.m_itemsNode.insertBefore(itemNode,beforeItem.GetNode());}else{this.m_itemsNode.appendChild(itemNode);}}},RenderItemStyle:function(layoutType,itemRenderer,item){if(itemRenderer==null){itemRenderer=this.GetDataList().GetItemRenderer();}if(layoutType==null){layoutType=this.GetDataList().GetLayoutType();}var itemSelectionNode=item.GetSelectionNode();if(itemSelectionNode!=null){itemSelectionNode.checked=item.IsSelected();}},RenderItems:function(items){var dataList=this.GetDataList();var itemRenderer=dataList.GetItemRenderer();var layoutType=dataList.GetLayoutType();var selectionMode=dataList.GetSelectionMode();var selectionControl=dataList.GetSelectionControl();var isItemClickEnabled=dataList.IsItemClickEnabled();var item=null;var itemTitle=null;var itemNode=null;var itemAnchorNode=null;var itemBlockNode=null;var itemMarginNode=null;var itemContentNode=null;var itemSummaryNode=null;var itemCheckboxNode=null;var itemControl=null;for(var i=0;i<items.length;i++){item=items[i];itemTitle=item.GetData().GetTitle();itemNode=dataList.CreateElement('li');itemTitle.AssignText(itemNode,'title');item.SetNode(itemNode);itemMarginNode=dataList.CreateElement('div');itemMarginNode.className='ddl_li_m';itemNode.appendChild(itemMarginNode);itemAnchorNode=dataList.CreateElement('a');itemTitle.AssignText(itemAnchorNode,'title');itemAnchorNode.className='d2l-link ddl_li_c';if(selectionMode!=D2L.Control.DataList.SelectionModes.None&&selectionControl!=D2L.Control.DataList.SelectionControls.Custom){var selectionNode=null;if(selectionControl==D2L.Control.DataList.SelectionControls.Input){if(selectionMode==D2L.Control.DataList.SelectionModes.Multiple){selectionNode=this.RenderCheckboxSelection(dataList,item);itemMarginNode.appendChild(selectionNode);}else if(selectionMode==D2L.Control.DataList.SelectionModes.Single){selectionNode=this.RenderRadioButtonSelection(dataList,item);itemMarginNode.appendChild(selectionNode);}if(isItemClickEnabled){itemAnchorNode.href='javascript://';}}else{if(item.IsEnabled()&&item.IsSelectable()||isItemClickEnabled){itemAnchorNode.href='javascript://';}selectionNode=itemAnchorNode;if(!dataList.IsItemClickEnabled()&&item.IsSelectable()){itemSummaryNode=dataList.CreateElement('span');itemSummaryNode.className='dsr';item.SetSummaryNode(itemSummaryNode);}}if(item.IsEnabled()&&item.IsSelectable()){this.InstallItemSelect(dataList,item,selectionNode);}}if(item.IsEnabled()){if(isItemClickEnabled){this.InstallItemClick(dataList,item,itemAnchorNode);}if(dataList.GetDragDropMode()!=D2L.DragDrop.Modes.None){this.InstallItemDragDrop(dataList,item,itemNode);}this.InstallItemMouseOver(dataList,item,itemNode);this.InstallItemMouseOut(dataList,item,itemNode);this.InstallItemBlur(dataList,item,itemAnchorNode);this.InstallItemFocus(dataList,item,itemAnchorNode);if(selectionNode!=null){this.InstallItemBlur(dataList,item,selectionNode);this.InstallItemFocus(dataList,item,selectionNode);}}itemBlockNode=dataList.CreateElement('div');itemBlockNode.className='ddl_li_b';itemTitle.AssignText(itemBlockNode,'title');itemAnchorNode.appendChild(itemBlockNode);itemControl=itemRenderer.Render(item);item.SetControl(itemControl);if(D2L.Util.IsD2LControl(itemControl)){itemControl.AppendTo(itemBlockNode);}else{itemBlockNode.appendChild(itemControl);}var clearNode=dataList.CreateElement('span');clearNode.className='clear';itemAnchorNode.appendChild(clearNode);if(itemSummaryNode!=null){itemAnchorNode.appendChild(itemSummaryNode);}if(layoutType==D2L.Control.DataList.LayoutTypes.Tiles){if(itemRenderer.GetTileItemWidth()>0){itemBlockNode.style.width=this.m_tileItemWidthEm+'em';}if(itemRenderer.GetTileItemHeight()>0){itemAnchorNode.style.minHeight=this.m_tileItemHeightEm+'em';}}else{if(itemRenderer.GetListItemHeight()>0){itemAnchorNode.style.minHeight=this.m_listItemHeightEm+'em';}}itemNode.appendChild(itemAnchorNode);item.SetAnchorNode(itemAnchorNode);this.m_itemsNode.appendChild(itemNode);this.RenderItemStyle(layoutType,itemRenderer,item);this.RenderItemText(item);}dataList.ItemsRenderedEvent().Trigger(items);},RenderCheckboxSelection:function(dataList,item){var checkboxNode=dataList.CreateElement('input');item.SetSelectionNode(checkboxNode);checkboxNode.type='checkbox';checkboxNode.className='d2l-checkbox';item.GetData().GetTitle().AssignText(checkboxNode,'title');checkboxNode.checked=item.IsSelected();checkboxNode.disabled=!item.IsEnabled();if(!item.IsSelectable()){checkboxNode.style.visibility='hidden';}if(item.IsSelected()&&item.GetNode()){item.GetNode().classList.add('vui-selected');}return checkboxNode;},RenderRadioButtonSelection:function(dataList,item){var radioButtonNode=dataList.CreateElement('input');item.SetSelectionNode(radioButtonNode);radioButtonNode.type='radio';radioButtonNode.name=dataList.GetMappedId();radioButtonNode.className='d2l-radio';item.GetData().GetTitle().AssignText(radioButtonNode,'title');radioButtonNode.checked=item.IsSelected();radioButtonNode.disabled=!item.IsEnabled();if(!item.IsSelectable()){radioButtonNode.style.visibility='hidden';}return radioButtonNode;},RenderItemText:function(item){var dataList=this.GetDataList();var itemSummaryNode=item.GetSummaryNode();var selectionMode=dataList.GetSelectionMode();var selectionControl=dataList.GetSelectionControl();if(itemSummaryNode!=null){var summary='';if(item.IsSelected()){summary=this.m_selectedMsg;}else{summary=this.m_unSelectedMsg;}summary.AssignText(itemSummaryNode,'innerHTML');}},RenderSummary:function(){this.m_summaryNode=this.CreateElement('span');this.m_summaryNode.className='dsr';this.GetDataList().GetSummary().AssignText(this.m_summaryNode,'innerHTML');this.GetDomNode().prepend(this.m_summaryNode);},RemoveItem:function(item){var itemNode=item.GetNode();D2L.Util.Dom.Purge(itemNode);this.m_itemsNode.removeChild(itemNode);item.Cleanup();},SelectListLayoutHandler:function(){this.GetDataList().SetLayoutType(D2L.Control.DataList.LayoutTypes.List);},SelectTilesLayoutHandler:function(){this.GetDataList().SetLayoutType(D2L.Control.DataList.LayoutTypes.Tiles);},DiscardElement:function(element){if(element!=null){var garbageBin=document.getElementById('IELeakGarbageBin');if(!garbageBin){garbageBin=document.createElement('div');garbageBin.id='IELeakGarbageBin';garbageBin.style.display='none';document.body.appendChild(garbageBin);}garbageBin.appendChild(element);garbageBin.innerHTML='';}},SetLayoutType:function(layoutType){var dataList=this.GetDataList();var rerenderRequired=dataList.GetItemRenderer().IsLayoutTypeSensitive()&&this.m_itemsNode.hasChildNodes();var items=dataList.GetItems();if(rerenderRequired){for(var i=0;i<items.length;i++){this.RemoveItem(items[i]);}}this.m_itemsNode.className=this.GetItemsNodeClassName(layoutType,dataList.GetStyle());if(rerenderRequired){this.RenderItems(items);}else{if(this.m_tileItemWidthEm>0){var applyDimensions=function(heightEm,widthEm){for(var i=0;i<items.length;i++){items[i].GetNode().firstChild.childNodes[0].style.height=heightEm;items[i].GetNode().firstChild.style.minHeight=heightEm;items[i].GetNode().firstChild.childNodes[1].style.width=widthEm;}};if(layoutType==D2L.Control.DataList.LayoutTypes.Tiles){applyDimensions(this.m_tileItemHeightEm+'em',this.m_tileItemWidthEm+'em');}else{applyDimensions(this.m_listItemHeightEm+'em','');}}}},SetSummary:function(summary){if(this.m_summaryNode!=null){summary.AssignText(this.m_summaryNode,'innerHTML');}}});D2L.Control.DataList.LANG_ERR_DATA_RETRIEVAL_PRIMARY='Framework.DataList.lblErrorRetrievingDataPrimary';D2L.Control.DataList.LANG_ERR_DATA_RETRIEVAL_SECONDARY='Framework.DataList.lblErrorRetrievingDataSecondary';D2L.Control.DataList.LayoutTypes={List:0,Tiles:1};D2L.Control.DataList.PagingTypes={None:0,Numeric:1};D2L.Control.DataList.SelectionModes={None:0,Multiple:1,Single:2};D2L.Control.DataList.SelectionControls={Input:0,Item:1,Custom:2};D2L.Control.DataList.Styles={Default:0,Normal:1};D2L.Control.DataList.Item=D2L.Class.extend({Construct:function(key,data){arguments.callee.$.Construct.call(this);this.m_anchorNode=null;this.m_selectionNode=null;this.m_control=null;if(data===undefined){data=null;}this.m_data=data;this.m_dataList=null;this.m_hasFocus=false;this.m_isEnabled=true;this.m_isSelectable=true;this.m_isSelected=false;if(key===undefined){key='';}this.m_key=key;this.m_node=null;this.m_overrideDraggability=false;this.m_overrideDroppability=false;this.m_parameters=new D2L.Util.Dictionary();this.m_selectionChangedEvent=new D2L.EventHandler();this.m_summaryNode=null;this.m_tempData=null;},Cleanup:function(){this.m_selectionNode=null;this.m_node=null;this.m_summaryNode=null;this.m_control=null;},Deserialize:function(deserializer){this.m_key=deserializer.GetMember('Key');this.m_isEnabled=deserializer.GetMember('IsEnabled');this.m_isSelectable=deserializer.GetMember('IsSelectable');if(this.m_isSelectable){this.m_isSelected=deserializer.GetMember('IsSelected');}else{this.m_isSelected=false;}this.m_tempData=deserializer.GetObject('Data');var parameters=deserializer.GetDictionary('Parameters');for(var key in parameters){this.m_parameters.Add(key,parameters[key]);}if(deserializer.HasMember("OverrideDraggability")){this.m_overrideDraggability=deserializer.HasMember("OverrideDraggability");}if(deserializer.HasMember("OverrideDroppability")){this.m_overrideDroppability=deserializer.HasMember("OverrideDroppability");}},GetAnchorNode:function(){return this.m_anchorNode;},GetControl:function(){return this.m_control;},GetData:function(){return this.m_data;},GetDataList:function(){return this.m_dataList;},GetDragDropMode:function(){var item=this;var dataList=this.GetDataList();var calculatedMode=dataList.GetDragDropMode();if(calculatedMode==D2L.DragDrop.Modes.DraggableDroppable){if(item.IsDraggabilityOverridden()){calculatedMode=D2L.DragDrop.Modes.Droppable;}if(item.IsDroppabilityOverridden()){calculatedMode=D2L.DragDrop.Modes.Draggable;}if(item.IsDroppabilityOverridden()&&item.IsDraggabilityOverridden()){calculatedMode=D2L.DragDrop.Modes.None;}}if(dataList.GetDragDropMode()==D2L.DragDrop.Modes.Draggable&&item.IsDraggabilityOverridden()){calculatedMode=D2L.DragDrop.Modes.None;}if(dataList.GetDragDropMode()==D2L.DragDrop.Modes.Droppable&&item.IsDroppabilityOverridden()){calculatedMode=D2L.DragDrop.Modes.None;}return calculatedMode;},GetKey:function(){return this.m_key;},GetNode:function(){return this.m_node;},GetParameter:function(name){return this.m_parameters.Get(name);},GetSelectionNode:function(){return this.m_selectionNode;},GetSummaryNode:function(){return this.m_summaryNode;},HasFocus:function(){return this.m_hasFocus;},Init:function(dataList){this.m_dataList=dataList;if(this.m_data==null){var dataClass=this.m_dataList.GetItemRenderer().GetDataClass();this.m_data=D2L.Serialization.JsonDeserializer.Deserialize(this.m_tempData,dataClass);}this.m_tempData=null;},IsDraggabilityOverridden:function(){return this.m_overrideDraggability;},IsDroppabilityOverridden:function(){return this.m_overrideDroppability;},IsEnabled:function(){return this.m_isEnabled;},IsSelectable:function(){if(this.m_dataList!=null&&this.m_dataList.GetSelectionMode()==D2L.Control.DataList.SelectionModes.None){return false;}else{return this.m_isSelectable;}},IsSelected:function(){return this.m_isSelected;},SelectionChangedEvent:function(){return this.m_selectionChangedEvent;},SetAnchorNode:function(anchorNode){this.m_anchorNode=anchorNode;},SetSelectionNode:function(selectionNode){this.m_selectionNode=selectionNode;},SetFocus:function(){if(this.m_dataList!=null){if(this.m_dataList.GetSelectionControl()==D2L.Control.DataList.SelectionControls.Item&&this.m_anchorNode!=null){this.m_anchorNode.focus();}else if(this.m_dataList.GetSelectionControl()==D2L.Control.DataList.SelectionControls.Input&&this.m_selectionNode!=null){this.m_selectionNode.focus();}}},SetControl:function(control){this.m_control=control;},SetHasFocus:function(hasFocus){this.m_hasFocus=hasFocus;},SetIsSelected:function(isSelected,doTriggerSelectEvent){if(this.IsSelectable()){if(this.m_dataList!=null){if(this.m_dataList.IsChangeSelectionAllowed(this)){if(doTriggerSelectEvent===undefined){doTriggerSelectEvent=true;}if(this.m_isSelected!=isSelected&&doTriggerSelectEvent){this.m_isSelected=isSelected;this.SelectionChangedEvent().Trigger(this);}else{this.m_isSelected=isSelected;}if(isSelected){this.m_dataList.SelectItem(this,doTriggerSelectEvent);}else{this.m_dataList.UnSelectItem(this,doTriggerSelectEvent);}}}else{this.m_isSelected=isSelected;}if(this.m_node){D2L.LP.Web.UI.Html.Dom.ToggleClassName('vui-selected',this.m_node,isSelected);}}},SetNode:function(node){this.m_node=node;},SetParameter:function(name,value){this.m_parameters.Add(name,value);},SetSummaryNode:function(summaryNode){this.m_summaryNode=summaryNode;},ToggleSelected:function(){this.SetIsSelected(!this.m_isSelected);}});D2L.Control.DataList.ItemStyle=D2L.Class.extend({Construct:function(){arguments.callee.$.Construct.call(this);this.m_backgroundColor='';this.m_border=new D2L.Style.BorderInfo(D2L.Style.BorderStyle.None,'',0);this.m_borderRadius=0;this.m_padding=new D2L.Style.Spacing(D2L.Style.Spacing.Type.Padding,D2L.Style.Spacing.UnitType.Em,0);this.m_spacing=new D2L.Style.Spacing(D2L.Style.Spacing.Type.Spacing,D2L.Style.Spacing.UnitType.Em,0);},GetBackgroundColor:function(){return this.m_backgroundColor;},GetBorder:function(){return this.m_border;},GetBorderRadius:function(){return this.m_borderRadius;},GetPadding:function(){return this.m_padding;},GetSpacing:function(){return this.m_spacing;},SetBackgroundColor:function(backgroundColor){this.m_backgroundColor=backgroundColor;},SetBorder:function(border){this.m_border=border;},SetBorderRadius:function(borderRadius){this.m_borderRadius=borderRadius;},SetPadding:function(padding){this.m_padding=padding;},SetSpacing:function(spacing){this.m_spacing=spacing;}});D2L.Control.DataList.RpcRequest=D2L.Class.extend({Construct:function(){arguments.callee.$.Construct.call(this);this.m_rpc='';this.m_rpcSrc='';this.m_paging=null;this.m_parameters={};this.m_sorting=[];},Serialize:function(serializer){serializer.AddMember('Rpc',this.m_rpc);serializer.AddMember('RpcSrc',this.m_rpcSrc);serializer.AddMember('Paging',this.m_paging);serializer.AddMember('Parameters',this.m_parameters);serializer.AddMember('Sorting',this.m_sorting);},SetPaging:function(paging){this.m_paging=paging;},SetParameters:function(parameters){this.m_parameters=parameters;},SetRpc:function(rpc){this.m_rpc=rpc;},SetRpcSrc:function(rpcSrc){this.m_rpcSrc=rpcSrc;},SetSorting:function(sorting){this.m_sorting=sorting;}});D2L.Control.DataList.RpcResponse=D2L.Class.extend({Construct:function(){arguments.callee.$.Construct.call(this);this.m_entityCount=0;this.m_errorMessages=[];this.m_items=[];this.m_pageCount=1;this.m_parameters=new D2L.Util.Dictionary();this.m_totalEntityCount=0;},Deserialize:function(deserializer){this.m_items=deserializer.GetObjectArray('Items',D2L.Control.DataList.Item);this.m_pageCount=deserializer.GetMember('PageCount');this.m_entityCount=deserializer.GetMember('EntityCount');this.m_totalEntityCount=deserializer.GetMember('TotalEntityCount');this.m_errorMessages=deserializer.GetObjectArray('ErrorMessages',D2L.LP.Text.IText);var parameters=deserializer.GetDictionary('Parameters');for(var key in parameters){this.m_parameters.Add(key,parameters[key]);}},GetEntityCount:function(){return this.m_entityCount;},GetErrorMessages:function(){return this.m_errorMessages;},GetItems:function(){return this.m_items;},GetPageCount:function(){return this.m_pageCount;},GetParameters:function(){return this.m_parameters;},GetTotalEntityCount:function(){return this.m_totalEntityCount;}});D2L.Control.DataList.ItemRenderer=D2L.Class.extend({Construct:function(){arguments.callee.$.Construct.call(this);var hoverBackground="#e7e7e7";var selectedBackground="#e8f2fc";this.m_dataClass=undefined;this.m_isLayoutTypeSensitive=false;this.m_tileItemWidth=0;this.m_tileItemHeight=0;this.m_listItemWidth=0;this.m_listItemHeight=0;this.m_itemStyle=new D2L.Control.DataList.ItemStyle();this.m_itemStyle.SetBackgroundColor('#ffffff');this.m_itemStyle.SetBorder(new D2L.Style.BorderInfo(D2L.Style.BorderStyle.Solid,'transparent',1));this.m_itemStyle.SetBorderRadius(0);this.m_itemStyle.SetPadding(new D2L.Style.Spacing(D2L.Style.Spacing.Type.Padding,D2L.Style.Spacing.UnitType.Em,0.3));this.m_itemStyle.SetSpacing(new D2L.Style.Spacing(D2L.Style.Spacing.Type.Spacing,D2L.Style.Spacing.UnitType.Em,0.3));this.m_selectedItemStyle=new D2L.Control.DataList.ItemStyle();this.m_selectedItemStyle.SetBackgroundColor(selectedBackground);this.m_selectedItemStyle.SetBorder(new D2L.Style.BorderInfo(D2L.Style.BorderStyle.Solid,'#99ccff',1));this.m_selectedItemStyle.SetBorderRadius(3);this.m_selectedItemStyle.SetPadding(new D2L.Style.Spacing(D2L.Style.Spacing.Type.Padding,D2L.Style.Spacing.UnitType.Em,0.3));this.m_selectedItemStyle.SetSpacing(new D2L.Style.Spacing(D2L.Style.Spacing.Type.Spacing,D2L.Style.Spacing.UnitType.Em,0.3));this.m_mouseOverItemStyle=new D2L.Control.DataList.ItemStyle();this.m_mouseOverItemStyle.SetBackgroundColor(hoverBackground);this.m_mouseOverItemStyle.SetBorder(new D2L.Style.BorderInfo(D2L.Style.BorderStyle.Solid,'#CCCCCC',1));this.m_mouseOverItemStyle.SetBorderRadius(3);this.m_mouseOverItemStyle.SetPadding(new D2L.Style.Spacing(D2L.Style.Spacing.Type.Padding,D2L.Style.Spacing.UnitType.Em,0.3));this.m_mouseOverItemStyle.SetSpacing(new D2L.Style.Spacing(D2L.Style.Spacing.Type.Spacing,D2L.Style.Spacing.UnitType.Em,0.3));this.m_disabledItemStyle=new D2L.Control.DataList.ItemStyle();this.m_disabledItemStyle.SetBackgroundColor('#ffffff');this.m_disabledItemStyle.SetBorder(new D2L.Style.BorderInfo(D2L.Style.BorderStyle.Solid,'transparent',1));this.m_disabledItemStyle.SetBorderRadius(3);this.m_disabledItemStyle.SetPadding(new D2L.Style.Spacing(D2L.Style.Spacing.Type.Padding,D2L.Style.Spacing.UnitType.Em,0.3));this.m_disabledItemStyle.SetSpacing(new D2L.Style.Spacing(D2L.Style.Spacing.Type.Spacing,D2L.Style.Spacing.UnitType.Em,0.3));},Deserialize:function(deserializer){this.m_tileItemWidth=deserializer.GetMember('TileItemWidth');this.m_tileItemHeight=deserializer.GetMember('TileItemHeight');this.m_listItemWidth=deserializer.GetMember('ListItemWidth');this.m_listItemHeight=deserializer.GetMember('ListItemHeight');},GetDataClass:function(){return this.m_dataClass;},GetDisabledItemStyle:function(layoutType){return this.m_disabledItemStyle;},GetFocusItemStyle:function(layoutType){return this.m_mouseOverItemStyle;},GetItemStyle:function(layoutType){return this.m_itemStyle;},GetListItemHeight:function(){return this.m_listItemHeight;},GetListItemWidth:function(){return this.m_listItemWidth;},GetMouseOverItemStyle:function(layoutType){return this.m_mouseOverItemStyle;},GetSelectedItemStyle:function(layoutType){return this.m_selectedItemStyle;},GetTileItemHeight:function(){return this.m_tileItemHeight;},GetTileItemWidth:function(){return this.m_tileItemWidth;},Init:function(dataList){},IsLayoutTypeSensitive:function(){return this.m_isLayoutTypeSensitive;},Render:function(dataItem){}});D2L.Control.DataList.ItemRendererData=D2L.Class.extend({Construct:function(){arguments.callee.$.Construct.call(this);this.m_title='';},Deserialize:function(deserializer){this.m_title=deserializer.GetObject('Title');if(this.m_title==null){this.m_title=new D2L.LP.Text.PlainText('');}},GetTitle:function(){return this.m_title;}});D2L.Control.DataList.TextItemRenderer=D2L.Control.DataList.ItemRenderer.extend({Construct:function(){arguments.callee.$.Construct.call(this);this.baseFontSize=UI.GetRelativeFontSizeManager().GetBaseFontSize();this.m_textFormat='0';},Deserialize:function(deserializer){arguments.callee.$.Deserialize.call(this,deserializer);this.m_textFormat=deserializer.GetMember('TextFormat');},GetDataClass:function(){return D2L.Control.DataList.TextItemRendererData;},Init:function(dataList){var me=this;dataList.SelectItemEvent().RegisterMethod(function(dataItem){me.SelectHandler(dataItem);});dataList.UnSelectItemEvent().RegisterMethod(function(dataItem){me.UnSelectHandler(dataItem);});},Render:function(dataItem){var data=dataItem.GetData();var dataList=dataItem.GetDataList();var layoutType=dataList.GetLayoutType();var navigation=dataItem.GetParameter('Navigation');var node=null;if(navigation!=null){node=dataList.CreateElement('a');node.setAttribute('href',navigation);node.setAttribute('target','_blank');}else{node=dataList.CreateElement('div');}node.className=this.GetContentCssClass(dataItem);var textNode=dataList.CreateElement('div');textNode.className='ddl_tr_c';var titleNode=dataList.CreateElement('div');titleNode.className='ddl_tr_t';if(this.m_textFormat==1){data.GetTitle().AssignHtml(titleNode,'innerHTML');}else{data.GetTitle().AssignText(titleNode,'innerHTML');}textNode.appendChild(titleNode);if(data.GetDescription()!=null){var descNode=dataList.CreateElement('div');descNode.className='ddl_tr_d';if(this.m_textFormat==1){data.GetDescription().AssignHtml(descNode,'innerHTML');}else{data.GetDescription().AssignText(descNode,'innerHTML');}textNode.appendChild(descNode);}var image=data.GetImage();if(image!=null){node.style.display='flex';var marginNode=dataList.CreateElement('div');marginNode.className='ddl_tr_m';node.appendChild(marginNode);var imageControl=new D2L.Control.Image();imageControl.SetImage(image);imageControl.AppendTo(marginNode);textNode.style.paddingLeft='18px';}node.appendChild(textNode);return node;},GetContentCssClass:function(dataItem){if(dataItem.IsEnabled()){if(dataItem.IsSelected()){return'ddl_trs';}else{return'ddl_tr';}}else{return'ddl_trd';}},SelectHandler:function(dataItem){dataItem.GetControl().className=this.GetContentCssClass(dataItem);},UnSelectHandler:function(dataItem){dataItem.GetControl().className=this.GetContentCssClass(dataItem);}});D2L.Control.DataList.TextItemRendererData=D2L.Control.DataList.ItemRendererData.extend({Construct:function(){arguments.callee.$.Construct.call(this);this.m_description=null;this.m_img=null;this.m_imgDisabled=null;},Deserialize:function(deserializer){arguments.callee.$.Deserialize.call(this,deserializer);this.m_description=deserializer.GetObject('Description');this.m_img=deserializer.GetObject('Img',D2L.Images.Image);if(this.m_img===undefined){this.m_img=null;}this.m_imgDisabled=deserializer.GetObject('ImgDisabled',D2L.Images.Image);if(this.m_imgDisabled===undefined){this.m_imgDisabled=null;}},GetDescription:function(){return this.m_description;},GetDisabledImage:function(){return this.m_imgDisabled;},GetImage:function(){return this.m_img;}});