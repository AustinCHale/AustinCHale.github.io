!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="ff3b01d7-b881-4c2b-9607-8c7361e6d3c5",e._sentryDebugIdIdentifier="sentry-dbid-ff3b01d7-b881-4c2b-9607-8c7361e6d3c5")}catch(e){}}();var _global="undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:{};_global.SENTRY_RELEASE={id:"production_v1.7.633_1_a106bba"},(()=>{var e={3633:e=>{e.exports=function(){var e=function(e){return"function"===typeof e},t=Math.pow(2,53)-1,n=function(e){var n=function(e){var t=Number(e);return isNaN(t)?0:0!==t&&isFinite(t)?(t>0?1:-1)*Math.floor(Math.abs(t)):t}(e);return Math.min(Math.max(n,0),t)},i=function(e){var t=e.next();return!Boolean(t.done)&&t};return function(t){"use strict";var o,a,r,s=this,d=arguments.length>1?arguments[1]:void 0;if("undefined"!==typeof d){if(!e(d))throw new TypeError("Array.from: when provided, the second argument must be a function");arguments.length>2&&(o=arguments[2])}var c=function(t,n){if(null!=t&&null!=n){var i=t[n];if(null==i)return;if(!e(i))throw new TypeError(i+" is not a function");return i}}(t,function(e){if(null!=e){if(["string","number","boolean","symbol"].indexOf(typeof e)>-1)return Symbol.iterator;if("undefined"!==typeof Symbol&&"iterator"in Symbol&&Symbol.iterator in e)return Symbol.iterator;if("@@iterator"in e)return"@@iterator"}}(t));if(void 0!==c){a=e(s)?Object(new s):[];var l,u,w=c.call(t);if(null==w)throw new TypeError("Array.from requires an array-like or iterable object");for(r=0;;){if(!(l=i(w)))return a.length=r,a;u=l.value,a[r]=d?d.call(o,u,r):u,r++}}else{var m=Object(t);if(null==t)throw new TypeError("Array.from requires an array-like object - not null or undefined");var g,h=n(m.length);for(a=e(s)?Object(new s(h)):new Array(h),r=0;r<h;)g=m[r],a[r]=d?d.call(o,g,r):g,r++;a.length=h}return a}}()}},t={};function n(i){var o=t[i];if(void 0!==o)return o.exports;var a=t[i]={exports:{}};return e[i](a,a.exports,n),a.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var i in t)n.o(t,i)&&!n.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{"use strict";var e=n(3633),t=n.n(e);const i={closedWidgetDimensions:{height:"0",width:"0"},isOpen:!1,isViewingImage:!1,placement:"bottom_right",size:"standard"},o=window.document.currentScript;if(!o)throw new Error("FT: Could not find embed script");const a=o.getAttribute("position"),r=o.getAttribute("position-x"),s=o.getAttribute("position-y"),d=o.getAttribute("offset-x")||"",c=o.getAttribute("offset-y")||"",l=/^[-]?\d+(px|rem)$/,u=l.test(d)?"calc(".concat(d," - 28px)"):"0",w=l.test(c)?"calc(".concat(c," - 28px)"):"0",m=()=>"left"===a||"left"===r||"bottom_left"===i.placement?"left":"right",g=()=>"left"===m()?"right":"left",h="top"===s?"top":"bottom",f="top"===h?"bottom":"top",v=()=>({border:"none",colorScheme:"normal",height:"0",maxHeight:"798px",overflow:"hidden",position:"fixed",[m()]:u,[g()]:"",[h]:w,[f]:"",webkitMaskImage:"-webkit-radial-gradient(white, black)",width:"0",zIndex:"999999"});function p(e,t){Object.entries({...v(),...t}).forEach((t=>{let[n,i]=t;e.style[n]=i}))}function b(e){p(e,{bottom:"0",height:"100%",left:"0",maxHeight:"initial",right:"0",top:"0",width:"100%"})}function y(e){return"null"===e?"*":e}let C=y(function(){try{var e;const t=null===(e=window.location.ancestorOrigins)||void 0===e?void 0:e[0];return t?new URL(t).origin:document.referrer?new URL(document.referrer).origin:""}catch{return""}}())||"*";const E=(e,t)=>{var n,i,o,a,r,s,d;null===(n=window.parent)||void 0===n||null===(i=n.postMessage)||void 0===i||i.call(n,e,t||C),null===(o=window)||void 0===o||null===(a=o.webkit)||void 0===a||null===(r=a.messageHandlers)||void 0===r||null===(s=r.widgetObservable)||void 0===s||null===(d=s.postMessage)||void 0===d||d.call(s,JSON.stringify(e));try{var c,l,u;null===(c=window)||void 0===c||null===(l=c.JSBridge)||void 0===l||null===(u=l.postMessage)||void 0===u||u.call(l,JSON.stringify(e))}catch{}try{var w,m,g;null===(w=window)||void 0===w||null===(m=w.ReactNativeWebView)||void 0===m||null===(g=m.postMessage)||void 0===g||g.call(m,JSON.stringify(e))}catch{}},_=e=>new Promise((t=>setTimeout(t,e)));async function S(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=e();return n||(t>4?null:(await _(2**t*600),S(e,t+1)))}const A=window.matchMedia("(max-width: 480px)"),k=window.matchMedia("(max-height: 700px)"),z="forethought-chat",T=window.document,I=T.currentScript,W="true"===(null===I||void 0===I?void 0:I.getAttribute("hide-ft-after-zd")),P=null===I||void 0===I?void 0:I.getAttribute("nonce"),q="false"!==(null===I||void 0===I?void 0:I.getAttribute("auto-open-zd")),L=null===I||void 0===I?void 0:I.getAttribute("hide-intercom-widget");let F="",M=!1;function x(e){return e instanceof Error?e.message:String(e)}const R=()=>{const e=T.getElementById(z),t=null===I||void 0===I?void 0:I.getAttribute("src"),n=t?y(new URL(t).origin):"*",i=t=>{var i;e&&(null===(i=e.contentWindow)||void 0===i||i.postMessage(t,n))},o=function(e,t){i({event:"updateHelpdeskConversation",forethoughtConversationID:arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,helpdeskConversationId:t,includeAttachments:arguments.length>3&&void 0!==arguments[3]&&arguments[3],includeTranscript:!(arguments.length>4&&void 0!==arguments[4])||arguments[4],integration:e})};function a(e){const t=T.createElement("style");return t.id=e,P&&(t.nonce=P),t}const r=a("ft-salesforce-style"),s=()=>{r.innerHTML="",T.body.appendChild(r)},d=()=>{r.innerHTML=".embeddedServiceHelpButton { display: none !important;}",T.body.appendChild(r)},c=()=>{let e=!0,t=0;const n=()=>{if(e&&t<=10){e=!1;const i=T.getElementsByClassName("chasitorText")[0];i?(i.value=F,function(e,t,n){if("createEvent"in T){const i=T.createEvent("HTMLEvents");i.keyCode=n,i.initEvent(t,!1,!0),e.dispatchEvent(i)}}(i,"keydown",13)):(e=!0,t++,setTimeout(n,1e3))}};n()},l=()=>{d(),window.Forethought("widget","show")};window.embedded_svc&&(window.embedded_svc.addEventHandler("afterDestroy",l),M=!0);const u=a("ft-zd-style"),w=()=>{try{window.zE&&window.zE("webWidget","hide")}catch{}try{window.zE&&window.zE("messenger","hide")}catch{}u.innerHTML='\n      iframe[id="launcher"] { display: none !important;}\n      iframe[title="Button to launch messaging window"] { display: none !important;}\n      iframe[title="Button to launch messaging window, conversation in progress"] { display: none !important;}\n      iframe[title="Message from company"] { display: none !important;}\n      iframe[data-product="web_widget"] { display: none !important ;}\n      ',T.body.appendChild(u)},m=()=>{try{window.zE&&window.zE("webWidget","show")}catch{}try{window.zE&&window.zE("messenger","show")}catch{}u.innerHTML='\n      iframe[id="launcher"] { display: block !important;}\n      iframe[title="Button to launch messaging window"] { display: block !important;}\n      iframe[title="Button to launch messaging window, conversation in progress"] { display: block !important;}\n      iframe[title="Message from company"] { display: block !important;}\n      iframe[data-product="web_widget"] { display: block !important;}\n    ',T.body.appendChild(u)},g=()=>{if(!window.zE)return i({event:"noZendeskObjectDetected"}),[];try{return window.zE("webWidget:get","chat:departments")||[]}catch{return[]}},h=e=>{if(!e)return;let t=!1;try{t=e("webWidget:get","chat:isChatting")}catch{}return"boolean"===typeof t&&(((e,t)=>{try{t?(m(),q&&e("webWidget","open"),window.Forethought("widget","hide")):w(),e("webWidget:on","chat:end",(function(){e&&(window.Forethought("widget","close"),W||(e("webWidget","close"),w(),window.Forethought("widget","show")))}))}catch{return}})(e,t),!0)},f=()=>{if(!window.zE)return i({event:"noZendeskObjectDetected"}),!1;try{const e=window.zE("webWidget:get","chat:isChatting");return"boolean"===typeof e&&e}catch{return!1}},v=a("ft-kustomer-style"),p=a("ft-intercom-style"),b=e=>{let{autoSendConfig:t,email:n,identityVerificationEnabled:i,isCurrentTabPrimary:o,name:a,question:r,userid:s}=e;const d={...window.intercomSettings};i||(a&&(d.name=a),s&&(d.user_id=s),n&&(d.email=n)),window.Intercom("update",d),p.innerHTML="",T.body.appendChild(p),r&&o?(window.Intercom("showSpace","messages"),setTimeout((()=>{window.Intercom("showNewMessage",r)}),1),t&&t.should_auto_send_message&&setTimeout((()=>{const e=T.querySelector('iframe[name="intercom-messenger-frame"]');if(e){var t;const n=null===(t=e.contentWindow)||void 0===t?void 0:t.document.querySelector(".intercom-composer-send-button");n&&n.click()}}),t.auto_send_timeout)):window.Intercom("show")},C=a("ft-snapengage-style"),A=()=>{window.SnapEngage&&window.SnapEngage.hideButton(),C.innerHTML="#designstudio-button { display: none !important;}",T.body.appendChild(C)},k=e=>{let{additionalParameters:t,email:n,isCurrentTabPrimary:i,name:o,question:a}=e;if(n&&window.SnapEngage.setUserEmail(n,!0),o&&window.SnapEngage.setUserName(o),window.SnapEngage&&window.SnapEngage.showButton(),C.innerHTML="#designstudio-button { display: block !important;}",T.body.appendChild(C),i){var r;window.SnapEngage.startLink();const e=null===(r=T.getElementById("designstudio-iframe").contentWindow)||void 0===r?void 0:r.document.getElementById("message-textarea");e&&a&&(e.value=a),null!==t&&void 0!==t&&t.transcript&&window.SnapEngage&&window.SnapEngage.setCallback("ChatMessageReceived",(function(e){const n=()=>{let e=!0;try{e&&(e=!1,window.SnapEngage.sendTextToChat(null===t||void 0===t?void 0:t.transcript))}catch(i){e=!0,window.SnapEngage.setCallback("ChatMessageReceived",""),setTimeout(n,5e3)}},i=null===t||void 0===t?void 0:t.bot_alias_list;i&&e&&!i.includes(e)&&(n(),window.SnapEngage.setCallback("ChatMessageReceived",""))}))}window.SnapEngage&&window.SnapEngage.setCallback("Close",(function(){A(),window.Forethought("widget","show")}))},R=e=>{let{email:t,isCurrentTabPrimary:n,name:i,question:o}=e;window.drift.on("ready",(function(){const e={};t&&(e.email=t),i&&(e.nickname=i),window.drift.api.setUserAttributes(e)})),o&&n&&window.drift.api.goToNewConversation(o),window.drift&&window.drift.api.openChat()},N=(e,t)=>{(e=>{switch(e){case"hide":return void window.Forethought("widget","hide");case"minimize":return void window.Forethought("widget","close");default:;}})(e),E({...t,event:"forethoughtWidgetGenericHandoff"})},O=a("ft-brand-embassy-style"),D=e=>{let{autoStartSession:t,customFields:n,isCurrentTabPrimary:i,name:o,question:a}=e;if(o&&window.brandembassy("setCustomerName",o),n)for(const[r,s]of Object.entries(n))window.brandembassy("setCustomField",r,s);i&&(window.brandembassy("hideFirstSentMessage",!1),window.brandembassy("sendFirstMessageAutomatically",a)),O.innerHTML="#be-frame {display: block !important;}",T.body.appendChild(O),window.brandembassy("openChatWindow"),t&&i&&window.brandembassy("autoStartSession")},H=a("ft-gorgias-style"),B=e=>{let{isCurrentTabPrimary:t,question:n}=e;H.innerHTML="#gorgias-chat-container {display: block !important;}",T.body.appendChild(H),window.GorgiasChat.hideChat(!1),window.GorgiasChat.open(),t&&window.GorgiasChat.sendMessage(n)},U=a("ft-freshchat-style"),V=e=>{let{conversationProperties:t,email:n,firstName:i,forethoughtConversationID:a,isCurrentTabPrimary:r,lastName:s,question:d,tags:c}=e;const l={},u={replyText:""};i&&(l.firstName=i),s&&(l.lastName=s),n&&(l.email=n),Object.keys(l).length&&window.fcWidget.user.setProperties(l),r&&((e=>{window.fcWidget.on("message:sent",(function(t){o("freshchat",t.message.conversationAlias,e,!1,!0),window.fcWidget.off("message:sent")}))})(a),c&&window.fcWidget.setTags(c),t&&Object.keys(t).length&&window.fcWidget.conversation.setConversationProperties({...t}),u.replyText=d),U.innerHTML="",T.body.appendChild(U),window.fcWidget.open(u)},j=a("ft-salesforce-messaging-style"),Z=()=>{j.innerHTML="",T.body.appendChild(j)},G=e=>{let{hiddenFields:t,isCurrentTabPrimary:n}=e;n?(window.embeddedservice_bootstrap.prechatAPI.setHiddenPrechatFields(t),Z(),(()=>{const e=T.querySelector('#embeddedMessagingConversationButton:not([title="Minimize the chat window"])');e&&e.click()})(),(()=>{const e=T.getElementById("embeddedMessagingFrame");if(e){var t;const i=e.contentDocument||(null===(t=e.contentWindow)||void 0===t?void 0:t.document);if(i){var n;const e=null===i||void 0===i||null===(n=i.querySelector("webruntime-app"))||void 0===n?void 0:n.querySelector("button.slds-button.minimizedButton");e&&e.click()}}})(),(()=>{var e;null===(e=T.getElementById("esw-fab"))||void 0===e||e.click()})()):Z()},K=a("ft-live-chat-style"),J=()=>{window.LiveChatWidget?window.LiveChatWidget.call("hide"):window.LC_API&&window.LC_API.hide_chat_window(),K.innerHTML="#chat-widget-container {display: none !important;}",T.body.appendChild(K)},Q=()=>{K.innerHTML="#chat-widget-container {display: block !important;}",T.body.appendChild(K)},Y=()=>{const e=window.LC_API;return!!e&&(!!e.is_loaded()&&(()=>{const e=window.LC_API;return!!e&&!!e.chat_running()&&(window.Forethought("widget","hide"),e.open_chat_window(),Q(),!0)})())},$=async e=>{var t;let{additionalParameters:n,department:a,email:r,featureFlags:d,forethoughtConversationID:c,integration:u,isCurrentTabPrimary:w,name:h,question:p,widgetOption:y}=e;F=p;const C=null===d||void 0===d?void 0:d.includes("next_avail_dept_routing"),E=null===d||void 0===d?void 0:d.includes("zendesk_department_verify_loop");switch(u){case"zendesk_messaging":const{authToken:e,customFieldsAndValues:d,ticketTags:q}=n,L=q.length>0,F=d.length>0;if(!window.zE)return X({error:"window.zE is undefined or Zendesk Messaging iframe is not found",integration:u,question:p,success:!1});window.Forethought("widget","hide"),m();try{e&&window.zE("messenger","loginUser",(function(t){t(e)})),L&&await window.zE("messenger:set","conversationTags",q),F&&await window.zE("messenger:set","conversationFields",d),window.zE("messenger:set","zIndex",9999999),window.zE("messenger","open")}catch(W){return X({customFields:d,error:x(W),integration:u,question:p,success:!1,ticketTags:q})}w&&((e,t)=>{let n=!0,i=0;const o=()=>{if(n&&i<=10){var a;if(n=!1,!e)return void t();const c=T.querySelector('iframe[title="Messaging window"]'),l=null===c||void 0===c||null===(a=c.contentWindow)||void 0===a?void 0:a.document.querySelector('textarea[data-garden-id="forms.textarea"]');if(l){var r,s,d;null===(r=Object.getOwnPropertyDescriptor(window.HTMLTextAreaElement.prototype,"value"))||void 0===r||null===(s=r.set)||void 0===s||s.call(l,e),l.dispatchEvent(new Event("change",{bubbles:!0}));const n=null===c||void 0===c||null===(d=c.contentWindow)||void 0===d?void 0:d.document.querySelector('button[data-garden-id="buttons.icon_button"][aria-label="Send message"]');n&&(n.click(),t())}else n=!0,i++,setTimeout(o,3e3)}else t()};o()})(p,(()=>{X({customFields:d,integration:u,question:p,success:!0,ticketTags:q})}));break;case"zendesk":const{chatTags:O,conversationIdUsedInPreviousSession:H="",ignoreAgentAvailability:U}=n,j=()=>{window.zE&&H&&window.zE("webWidget","chat:removeTags",["ft-conversation-id_".concat(H)])};if(!window.zE)return X({chatTags:O,departmentReceived:a,departmentReceivedName:a,email:r,error:"window.zE is undefined",ignoreAgentAvailability:U,integration:u,name:h,question:p,success:!1});const Z=null===(t=T.getElementById("launcher"))||void 0===t?void 0:t.parentElement;Z&&(Z.style.display="block");const K=E?await(async()=>{let e=[];try{const t=20,n=500;for(let i=0;i<t&&(await _(n),!(window.zE&&(e=window.zE("webWidget:get","chat:departments")||[],e.length>0)));++i);}catch(W){e=[]}return e})().then((e=>e.filter((e=>"online"===e.status)))):g().filter((e=>"online"===e.status));let J="";const Y=parseInt(a),$=isNaN(Y)?null:Y;if($){var S;const e=g();J=(null===e||void 0===e||null===(S=e.find((e=>e.id===$)))||void 0===S?void 0:S.name)||""}else J=a;const ee=K.some((e=>e.name===J));if(K.length){if(!C&&J&&!ee)return X({chatTags:O,departmentReceived:a,departmentReceivedName:J,departments:g(),email:r,error:"Department is offline",ignoreAgentAvailability:U,integration:u,isReceivedDepartmentOnline:ee,name:h,question:p,success:!1});try{j(),window.zE("webWidget","open")}catch(W){return X({chatTags:O,departmentReceived:a,departmentReceivedName:J,departments:g(),email:r,error:W instanceof Error?W.message:"Unknown window.zE(...) invocation error",ignoreAgentAvailability:U,integration:u,isReceivedDepartmentOnline:ee,name:h,question:p,success:!1})}await new Promise((e=>{window.zE&&window.zE((async()=>{if(window.zE){if(h||r)try{window.zE.identify({email:r,name:h})}catch(W){return X({chatTags:O,departmentReceived:a,departmentReceivedName:J,departments:g(),email:r,error:W instanceof Error?W.message:"Unknown window.zE.identify({ email, name }) invocation error",ignoreAgentAvailability:U,integration:u,isReceivedDepartmentOnline:ee,name:h,question:p,success:!1})}if(a&&ee){const e=5,t=500,n=async()=>{try{for(let n=0;n<e;++n)if(await _(t),window.zE){const e=f();window.zE&&window.zE("webWidget","updateSettings",{webWidget:{chat:{departments:{select:J}}}}),i({event:"zendeskUpdateSettings",updateSettingsData:{department:J,departments:g(),error:"",executionNumber:n+1,isReceivedDeptOnline:ee,isSent:!0,isSessionActive:e,timeOfTrackingEvent:Date.now(),...$&&{departmentId:$}}})}}catch(W){i({event:"zendeskUpdateSettings",updateSettingsData:{department:J,departments:g(),error:W instanceof Error?W.message:"Unknown window.zE(webWidget, updateSettings) invocation error",isReceivedDeptOnline:ee,isSent:!1,timeOfTrackingEvent:Date.now(),...$&&{departmentId:$}}})}};await n()}try{O&&window.zE("webWidget","chat:addTags",O)}catch(W){return X({chatTags:O,departmentReceived:a,departmentReceivedName:J,departments:g(),email:r,error:W instanceof Error?W.message:"Unknown window.zE(webWidget, chat:addTags) invocation error",ignoreAgentAvailability:U,integration:u,isReceivedDepartmentOnline:ee,name:h,question:p,success:!1})}m(),p&&w?setTimeout((()=>{try{var t,n;null===(t=(n=window).zE)||void 0===t||t.call(n,"webWidget","chat:send",p),e()}catch(W){X({chatTags:O,departmentReceived:a,departmentReceivedName:J,departments:g(),email:r,error:W instanceof Error?W.message:"Unknown window.zE('webWidget', 'chat:send', question) invocation error",ignoreAgentAvailability:U,integration:u,isReceivedDepartmentOnline:ee,name:h,question:p,success:!1})}}),3e3):e()}}))})),X({chatTags:O,departmentReceived:a,departmentReceivedName:J,departments:g(),email:r,ignoreAgentAvailability:U,integration:u,isReceivedDepartmentOnline:ee,name:h,question:p,success:!0})}else if(U){m();try{j(),window.zE("webWidget","open"),window.zE((()=>{try{window.zE&&((h||r)&&window.zE.identify({email:r,name:h}),O&&window.zE("webWidget","chat:addTags",O),J&&window.zE("webWidget","updateSettings",{webWidget:{chat:{departments:{select:J}}}}),setTimeout((()=>{var e,t;p&&w&&(null===(e=(t=window).zE)||void 0===e||e.call(t,"webWidget","chat:send",p))}),3e3))}catch(W){return X({chatTags:O,departmentReceived:a,departmentReceivedName:J,departments:g(),email:r,error:W instanceof Error?W.message:"Unknown window.zE(...) invocation error",ignoreAgentAvailability:U,integration:u,isReceivedDepartmentOnline:ee,name:h,question:p,success:!1})}}))}catch(W){return X({chatTags:O,departmentReceived:a,departmentReceivedName:J,departments:g(),email:r,error:W instanceof Error?W.message:"Unknown window.zE(...) invocation error",ignoreAgentAvailability:U,integration:u,isReceivedDepartmentOnline:ee,name:h,question:p,success:!1})}X({chatTags:O,departmentReceived:a,departmentReceivedName:J,departments:g(),email:r,ignoreAgentAvailability:U,integration:u,isReceivedDepartmentOnline:ee,name:h,question:p,success:!0})}else X({chatTags:O,departmentReceived:a,departmentReceivedName:J,departments:g(),email:r,error:"All departments are offline",ignoreAgentAvailability:U,integration:u,isReceivedDepartmentOnline:ee,name:h,question:p,success:!1});break;case"salesforce":const{extraPrechatFormDetails:te=[],manually_click_salesforce_button:ne=!1,manually_click_timeout:ie=0,...oe}=n;if(!window.embedded_svc)return X({error:"window.embedded_svc is undefined",integration:u,manuallyClickSalesforceButton:ne,success:!1});const ae={};if(!M){var A;if(null===(A=window.embedded_svc)||void 0===A||!A.addEventHandler)return X({error:"window.embedded_svc.addEventHandler is undefined",integration:u,manuallyClickSalesforceButton:ne,success:!1});window.embedded_svc.addEventHandler("afterDestroy",l),M=!0}if(s(),window.Forethought("widget","hide"),w){const e={};if(h){const{firstName:t,lastName:n}=(e=>{const t=e.trim().replace(/\s{2,}/g," ").split(" "),n=t.length&&t[0]?t[0]:"";return{firstName:n,lastName:t.length>1?t.slice(1).join(" "):n}})(h);e.Name=h,e.FirstName=t,e.LastName=n}const t={extraPrechatFormDetails:te,prepopulatedPrechatFields:{Email:r,Subject:p,...e,...oe}};if(ae.startChatFields={...t},ne){var z;let e=!0;if(null===(z=window.embedded_svc)||void 0===z||!z.addEventHandler)return X({error:"window.embedded_svc.addEventHandler is undefined",integration:u,manuallyClickSalesforceButton:ne,success:!1});window.embedded_svc.addEventHandler("afterMaximize",(()=>{setTimeout((()=>{if(e){var n;if(null===(n=window.embedded_svc.liveAgentAPI)||void 0===n||!n.startChat)return X({error:"window.embedded_svc.liveAgentAPI.startChat is undefined",integration:u,manuallyClickSalesforceButton:ne,success:!1});window.embedded_svc.liveAgentAPI.startChat({...t}).then((()=>{e=!1}))}}),ie)}));const n=document.querySelector("div.embeddedServiceHelpButton button");n?(n.click(),X({...ae,integration:u,manuallyClickSalesforceButton:ne,success:!0})):X({...ae,error:"Salesforce chat button is not found",integration:u,manuallyClickSalesforceButton:ne,success:!1})}else{var I;if(null===(I=window.embedded_svc.liveAgentAPI)||void 0===I||!I.startChat)return X({error:"window.embedded_svc.liveAgentAPI.startChat is undefined",integration:u,manuallyClickSalesforceButton:ne,success:!1});window.embedded_svc.liveAgentAPI.startChat({...t}),X({...ae,integration:u,manuallyClickSalesforceButton:ne,success:!0})}}break;case"kustomer":if(!window.Kustomer)return X({customFields:{...n.customFields},error:"window.Kustomer is undefined",integration:u,question:p,success:!1});const re=window.Kustomer.isChatAvailable();if(void 0===re)return X({customFields:{...n.customFields},error:"Kustomer.isChatAvailable() returned undefined",integration:u,question:p,success:!1});const{availability:se}=re;if("disabled"===se||"hidden"===se)return X({customFields:{...n.customFields},error:"Chat is ".concat(se),integration:u,question:p,success:!1,widgetAvailability:se});if(w)try{r&&window.Kustomer.describeCustomer({attributes:{emails:[r]}}),window.Kustomer.createConversation({customAttributes:{...n.customFields},message:p||"Conversation via Forethought",...n.assistantId?{assistantId:n.assistantId}:{}},(function(e,t){if(t||!e)throw t;{const t=!0,i=!0;o(u,e.conversationId,c,t,i),v.innerHTML="#kustomer-ui-sdk-iframe { display: block !important;}",T.body.appendChild(v),window.Forethought("widget","hide"),X({customFields:{...n.customFields},integration:u,question:p,success:!0,widgetAvailability:se})}}))}catch(P){return X({customFields:{...n.customFields},error:x(P),integration:u,question:p,success:!1})}break;case"intercom":if(!window.Intercom)return X({autoSendConfig:n.autoSendConfig,email:r,error:"window.Intercom is undefined",identityVerificationEnabled:n.identityVerificationEnabled,integration:u,name:h,question:p,success:!1,userid:n.userid});try{b({autoSendConfig:n.autoSendConfig,email:r,identityVerificationEnabled:n.identityVerificationEnabled,isCurrentTabPrimary:w,name:h,question:p,userid:n.userid})}catch(P){return X({autoSendConfig:n.autoSendConfig,email:r,error:x(P),identityVerificationEnabled:n.identityVerificationEnabled,integration:u,name:h,question:p,success:!1,userid:n.userid})}X({autoSendConfig:n.autoSendConfig,email:r,identityVerificationEnabled:n.identityVerificationEnabled,integration:u,name:h,question:p,success:!0,userid:n.userid});break;case"snap_engage":if(!window.SnapEngage||!window.SnapEngage.startLink||!window.SnapEngage.sendTextToChat)return X({additionalParameters:n,email:r,error:"window.SnapEngage is undefined, or is missing necessary functions",integration:u,name:h,question:p,success:!1});try{k({additionalParameters:n,email:r,isCurrentTabPrimary:w,name:h,question:p})}catch(P){return X({additionalParameters:n,email:r,error:x(P),integration:u,name:h,question:p,success:!1})}X({additionalParameters:n,email:r,integration:u,name:h,question:p,success:!0});break;case"drift":if(!window.drift)return X({email:r,error:"window.drift is undefined",integration:u,name:h,question:p,success:!1});try{R({email:r,isCurrentTabPrimary:w,name:h,question:p})}catch(P){return X({email:r,error:x(P),integration:u,name:h,question:p,success:!1})}X({email:r,integration:u,name:h,question:p,success:!0});break;case"generic":try{N(y,{...n}),X({...n,integration:u,success:!0,widgetOption:y},!1)}catch(P){X({...n,error:x(P),integration:u,success:!1,widgetOption:y},!1)}break;case"brand_embassy":const{autoStartSession:de,customFields:ce}=n;if(!window.brandembassy)return X({autoStartSession:de,customFields:ce,error:"window.brandembassy is undefined",integration:u,name:h,question:p,success:!1});try{D({autoStartSession:de,customFields:ce,isCurrentTabPrimary:w,name:h,question:p})}catch(P){return X({autoStartSession:de,customFields:ce,error:x(P),integration:u,name:h,question:p,success:!1})}X({autoStartSession:de,customFields:ce,integration:u,name:h,question:p,success:!0});break;case"gorgias":if(!window.GorgiasChat)return X({error:"window.GorgiasChat is undefined",integration:u,question:p,success:!1});try{B({isCurrentTabPrimary:w,question:p})}catch(P){return X({error:x(P),integration:u,question:p,success:!1})}X({integration:u,question:p,success:!0});break;case"freshchat":{const{conversationProperties:e,firstName:t,lastName:i,tags:o}=n;if(!window.fcWidget)return X({conversationProperties:e,email:r,error:"window.fcWidget is not found",firstName:t,forethoughtConversationID:c,integration:u,lastName:i,question:p,success:!1,tags:o});try{V({conversationProperties:e,email:r,firstName:t,forethoughtConversationID:c,isCurrentTabPrimary:w,lastName:i,question:p,tags:o})}catch(P){return X({conversationProperties:e,email:r,error:x(P),firstName:t,forethoughtConversationID:c,integration:u,lastName:i,question:p,success:!1,tags:o})}X({conversationProperties:e,email:r,firstName:t,forethoughtConversationID:c,integration:u,lastName:i,question:p,success:!0,tags:o});break}case"salesforce_messaging":{const e=n.hiddenFields||{};if(!window.embeddedservice_bootstrap)return X({error:"window.embeddedservice_bootstrap is undefined",hiddenFields:e,integration:u,question:p,success:!1});try{G({hiddenFields:e,isCurrentTabPrimary:w})}catch(P){return X({error:x(P),hiddenFields:e,integration:u,question:p,success:!1})}X({hiddenFields:e,integration:u,question:p,success:!0});break}case"live_chat":if(void 0===window.LiveChatWidget&&void 0===window.LC_API)return X({email:r,error:"both window.LiveChatWidget and window.LC_API are undefined",integration:"live_chat",name:h,question:p,success:!1});try{window.LiveChatWidget?(e=>{let{email:t,isCurrentTabPrimary:n,name:i,question:o}=e;window.LiveChatWidget&&(Q(),i&&window.LiveChatWidget.call("set_customer_name",i),t&&window.LiveChatWidget.call("set_customer_email",t),n&&(window.LiveChatWidget.call("set_session_variables",{"Forethought Transcript":o}),window.LiveChatWidget.call("maximize")))})({email:r,isCurrentTabPrimary:w,name:h,question:p}):window.LC_API&&(e=>{let{email:t,isCurrentTabPrimary:n,name:i,question:o}=e;if(window.LC_API&&(Q(),i&&window.LC_API.set_visitor_name(i),t&&window.LC_API.set_visitor_email(t),n)){const e=[{name:"Forethought Transcript",value:o}];window.LC_API.set_custom_variables(e),window.LC_API.open_chat_window()}})({email:r,isCurrentTabPrimary:w,name:h,question:p})}catch(P){return X({email:r,error:x(P),integration:"live_chat",name:h,question:p,success:!1})}X({email:r,integration:"live_chat",name:h,question:p,success:!0});break;default:X({error:"Unknown integration: ".concat(u),integration:u,question:p,success:!1})}},X=function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];console.log("Forethought ".concat(e.integration," handoff"),e),i({event:"handoffStatus",handoffFailureMessage:e.error,hideWidget:t,success:e.success});const n={event:"forethoughtWidgetIntegrationHandoffCompleted",handoffData:e,success:e.success};window.postMessage(n),i({event:"handoffTrackingEvent",handoffData:e})};window.addEventListener("message",(e=>{const t=e.data,n=null===t||void 0===t?void 0:t.data,i=null===t||void 0===t?void 0:t.method;"liveagent.restored"===i&&window.embedded_svc.liveAgentAPI.browserSessionInfo.activeChatSessions&&window.Forethought("widget","hide"),"liveagent.initialized"===i&&(s(),window.Forethought("widget","hide")),"chasitorChatEstablished"===(null===n||void 0===n?void 0:n.event)&&c()})),window.addEventListener("message",(e=>{if((e=>Boolean((e.origin===n||"*"===n)&&e.data))(e))return"forethoughtWidgetLoaded"===e.data.event?(window.zE?e.data.isLiveChatMode?w():S((()=>h(window.zE))):w(),window.LC_API?S(Y).then((e=>{e||J()})):J(),d(),v.innerHTML="#kustomer-ui-sdk-iframe { display: none !important;}",T.body.appendChild(v),"false"!==L&&(window.Intercom&&window.Intercom("hide"),p.innerHTML='\n      .intercom-launcher {display: none !important;}\n      .intercom-messenger-frame {display: none !important;}\n      .intercom-lightweight-app {display: none !important;}\n      .intercom-launcher-frame {display: none !important;}\n      [class*="intercom-with-namespace-"] {display: none !important;}\n    ',T.body.appendChild(p)),A(),window.drift&&window.drift.hide(),O.innerHTML="#be-frame {display: none !important;}",T.body.appendChild(O),H.innerHTML="#gorgias-chat-container {display: none !important;}",T.body.appendChild(H),U.innerHTML="\n      #fc_frame {display: none !important;}\n      freshchat-widget {display: none !important;}\n    ",T.body.appendChild(U),j.innerHTML="\n      #embedded-messaging {display: none !important;}\n      #embedded-service {display: none !important;}\n    ",void T.body.appendChild(j)):void("forethoughtWidgetIntegrationHandoff"!==e.data.event||$(e.data))}))},N="forethought-zopim",O=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return new Promise((t=>{var i;if(!window.zChat)return t();null===(i=window.zChat)||void 0===i||i[e](...n,(n=>{n&&"endChat"!==e&&console.error({error:n,fn:e}),t()}))}))},D=function(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:250;return function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];window.clearTimeout(t),t=window.setTimeout((()=>{e(...o)}),n)}}(((e,t)=>{var n;if(null===(n=window.zChat)||void 0===n||!n.getAccountStatus()){var i,o,a,r,s;const t={account_key:e,suppress_console_error:!1};null!==(i=window.zESettings)&&void 0!==i&&null!==(o=i.webWidget)&&void 0!==o&&null!==(a=o.authenticate)&&void 0!==a&&null!==(r=a.chat)&&void 0!==r&&r.jwtFn&&(t.authentication={jwt_fn:window.zESettings.webWidget.authenticate.chat.jwtFn}),null===(s=window.zChat)||void 0===s||s.init(t)}t()}),500);let H;const B=async e=>{let{conversationId:t,conversationIdUsedInPreviousSession:n,integrationFields:i,liveChatWidgetComponent:o,targetOrigin:a="*"}=e;if(null===o||void 0===o||!o.isSent){const e=((e,t)=>{const n=null===(e=i.department_with_id)||void 0===e?void 0:e.id,o=null===(t=i.department_with_id)||void 0===t?void 0:t.name;return n&&!isNaN(parseInt(n))?parseInt(n):o&&!isNaN(parseInt(o))?parseInt(o):void 0})(),r=[...i.chat_tags||[],"ft-conversation-id_".concat(t)],s=()=>{var e;return"zendesk"!==(null===o||void 0===o?void 0:o.component_fields.integration_config.integration)||null===o||void 0===o||null===(e=o.component_fields.integration_config.integration_fields)||void 0===e||!e.ignore_agent_availability},d=e=>{const t=document.getElementById(z);var n;t?null===(n=t.contentWindow)||void 0===n||n.postMessage(e,a):window.postMessage(e)};H&&clearTimeout(H),H=setTimeout((async()=>{if(e&&s()){var a;const t=null===(a=window.zChat)||void 0===a?void 0:a.getDepartment(e);if(!t||"offline"===t.status){const n={error:"Department ".concat(e,t?" is offline":" is undefined"),event:"forethoughtZopimFailure"};return void d(n)}}d({event:"forethoughtZopimPending"}),await O("endChat",{clear_dept_id_on_chat_ended:!0}),e&&(await O("clearVisitorDefaultDepartment"),await O("setVisitorDefaultDepartment",e)),await O("removeTags",["ft-conversation-id_".concat(n)]),await O("addTags",r),await O("setVisitorInfo",{display_name:i.visitor_name||"",email:i.visitor_email||""}),await O("sendChatMsg",(null===o||void 0===o?void 0:o.component_fields.customer_facing_transcript)||"");const c={event:"forethoughtSendTrackingEvent",trackingEvent:{conversation_id:t,department_id:e,display_name:i.visitor_name,email:i.visitor_email,event_type:"widget-customer-handoff",integration:"zendesk-zopim-live-chat",success:!0,tags:r}};d(c)}),5e3)}},U=()=>{const e=document.getElementById(z),t="*",n=n=>{var i;null===(i=e.contentWindow)||void 0===i||i.postMessage({event:"forethoughtZopimAgentUpdate",zopimData:n},t)},i=n=>{var i,o;null===(i=e.contentWindow)||void 0===i||i.postMessage({event:"forethoughtZopimChat",zopimAgents:(null===(o=window.zChat)||void 0===o?void 0:o.getServingAgentsInfo())||[],zopimData:n},t)},o=n=>{var i;null===(i=e.contentWindow)||void 0===i||i.postMessage({event:"forethoughtZopimConnectionUpdate",zopimData:n},t)},a=()=>{var e,t,a;null===(e=window.zChat)||void 0===e||e.on("agent_update",n),null===(t=window.zChat)||void 0===t||t.on("chat",i),null===(a=window.zChat)||void 0===a||a.on("connection_update",o)};window.addEventListener("message",(e=>{var r;switch(e.data.event){case"forethoughtZopimInit":const{conversationId:d,conversationIdUsedInPreviousSession:c,integrationFields:l,liveChatWidgetComponent:u}=e.data;if(window.zChat)D(l.account_key,a),B({conversationId:d,conversationIdUsedInPreviousSession:c,integrationFields:l,liveChatWidgetComponent:u,targetOrigin:t});else{var s;const e=document.createElement("script");e.id=N,e.src="https://dev.zopim.com/web-sdk/1.11.2/web-sdk.js",e.fetchPriority="high",e.onload=()=>{D(l.account_key,a),B({conversationId:d,conversationIdUsedInPreviousSession:c,integrationFields:l,liveChatWidgetComponent:u,targetOrigin:t})};const n=null===(s=document.currentScript)||void 0===s?void 0:s.getAttribute("nonce");n&&(e.nonce=n),document.body.appendChild(e)}break;case"forethoughtZopimRemove":(()=>{var e,t,a;null===(e=window.zChat)||void 0===e||e.un("agent_update",n),null===(t=window.zChat)||void 0===t||t.un("chat",i),null===(a=window.zChat)||void 0===a||a.un("connection_update",o)})(),null===(r=document.getElementById(N))||void 0===r||r.remove();break;case"forethoughtZopimApplyFunction":if(window.zChat)if("sendFile"===e.data.functionName)try{const t=e.data.args[0],n=e.data.args[1].split(",")[1];e.data.args[0]=V(t,n),window.zChat[e.data.functionName](e.data.args[0],...e.data.args.slice(2))}catch(e){break}else window.zChat[e.data.functionName](...e.data.args)}}))},V=(e,t)=>{const n=atob(t),i=new Array(n.length);for(let r=0;r<n.length;r++)i[r]=n.charCodeAt(r);const o=new Uint8Array(i),a=new Blob([o],{type:e.type});return new File([a],e.name,{type:e.type})};Array.from=t(),function(e){const t=window.document,n=t.currentScript;if(!n)throw new Error("FT: Could not find embed script");const o=n.getAttribute("data-api-key"),a=(()=>{const e=window.document.currentScript;if(!e)throw new Error("FT: Could not find embed script");const t=e.getAttribute("offset-x")||"0px",n="0px"===t?"6px":"30px";return window.matchMedia("(min-width: 481px) and (max-width: calc(688px + ".concat(t," - ").concat(n,"))"))})();if(!o)return;const r=n.getAttribute("full-screen"),s=n.getAttribute("hidden"),d="true"===n.getAttribute("data-builder-preview"),c="true"===n.getAttribute("data-solve-config-preview"),l=n.getAttribute("offset-x")||"0px",u=n.getAttribute("offset-y")||"0px",w=n.getAttribute("data-workflow-version"),m=null===(e=n.getAttribute("src"))||void 0===e?void 0:e.replace("embed.js",""),g={};Array.from(n.attributes).forEach((e=>{const t=e.nodeValue,n="null"===t;g[e.nodeName]=n?null:t}));const h=function(){var e;if(t.querySelector("#forethought-chat"))return void console.warn("Detected duplicate Forethought embed script. If you want to initialize the widget with new parameters, you need to remove the old Forethought iframe first.");const h=t.createElement("iframe");h.setAttribute("id",z),h.setAttribute("name","Virtual Assistant Chat"),h.setAttribute("title","Virtual Assistant Chat"),h.setAttribute("allowfullscreen","allowfullscreen"),h.setAttribute("mozallowfullscreen","mozallowfullscreen"),h.setAttribute("msallowfullscreen","msallowfullscreen"),h.setAttribute("oallowfullscreen","oallowfullscreen"),h.setAttribute("webkitallowfullscreen","webkitallowfullscreen"),h.setAttribute("sandbox","allow-scripts allow-popups allow-top-navigation-by-user-activation allow-same-origin allow-popups-to-escape-sandbox allow-downloads allow-top-navigation");const v=Object.fromEntries(Array.from(n.getAttributeNames(),(e=>[e,n.getAttribute(e)||""]))),C=new URLSearchParams(v);h.setAttribute("src",m+"?v=2#".concat(C)),p(h),t.body.appendChild(h);const E=m?y(new URL(m).origin):"*",_=e=>{var t;null===(t=h.contentWindow)||void 0===t||t.postMessage(e,E)};function S(e){let{height:t,width:n}=e;p(h,{height:t,width:n})}function T(){S({height:"100%",width:"calc(280px + 48px)"})}function I(){const e="large"===i.size?640:400;if(d)t=h,n={maxWidth:"".concat(e,"px")},p(t,{borderRadius:"12px 0 0 12px",bottom:"0",height:"calc(100% - 69px)",maxHeight:"initial",right:"0",width:"100%",zIndex:"1199",...n});else{const t="".concat(e+48,"px"),n="48px",o="24px";S({height:"0px"===u?"calc(90% - ".concat(u," - ").concat(n,")"):"calc(100% - ".concat(u," + ").concat(o,")"),width:"large"===i.size&&a.matches?"calc(100% - ".concat(l,"0px"===l?" + 6px)":" + 30px)"):t})}var t,n}const W=()=>{h.hidden=!0},P=()=>{const e=A.matches,t=k;i.isOpen&&e?_({event:"forethoughtWidgetScreenSizeEvent",isMobile:!0,isSmallScreen:!1}):!i.isOpen||e||d||_({event:"forethoughtWidgetScreenSizeEvent",isMobile:!1,isSmallScreen:t.matches})},q=()=>{if(!i.isViewingImage)if(P(),i.isOpen){A.matches?b(h):I()}else"0"===i.closedWidgetDimensions.width?T():S(i.closedWidgetDimensions)},L=()=>{h.hidden=!1,i.isOpen?_({action:"showIframeOpen"}):_({action:"showIframe"})},F=()=>window.document.getElementById(z),M=()=>{var e,t;return{offsetLeft:(null===(e=window.visualViewport)||void 0===e?void 0:e.offsetLeft)||0,offsetTop:(null===(t=window.visualViewport)||void 0===t?void 0:t.offsetTop)||0}};window.addEventListener("message",(e=>{var t;if(t=e,Boolean((t.origin===E||"*"===E)&&t.data))switch(e.data.event){case"hideSolveWidget":W();break;case"showSolveWidget":L();break;case"hideIframeWidget":F()&&W();break;case"showIframeWidget":F()&&L();break;case"forethoughtWidgetOpened":i.isOpen=!0,q();break;case"forethoughtWidgetClosed":i.isOpen=!1,q();break;case"forethoughtWidgetStartedInitializing":const t=A.matches,n=k;t?_({event:"forethoughtWidgetScreenSizeEvent",isMobile:!0,isSmallScreen:!1}):t||_({event:"forethoughtWidgetScreenSizeEvent",isMobile:!1,isSmallScreen:n.matches}),"true"===r&&_({action:"openWidget",mechanism:"full-screen-true"}),s&&W(),_({API_KEY:o,event:"forethoughtWidgetInitEvent",href:window.location.href,isBuilderPreview:d,isSolveConfigPreview:c,origin:f(),rawParams:g,widgetInitMethod:"script",workflowVersion:w}),P();break;case"forethoughtWidgetLoaded":i.isOpen=e.data.isOpen,i.size=e.data.size,i.placement=e.data.placement,q(),"function"===typeof A.addEventListener?(A.addEventListener("change",q),a.addEventListener("change",q),k.addEventListener("change",q)):(A.addListener(q),a.addListener(q),k.addListener(q));break;case"forethoughtWidgetResize":if(i.isOpen)return;const{height:l,width:u}=e.data.dimensions;l&&u&&(i.closedWidgetDimensions={height:l,width:u},S(i.closedWidgetDimensions));break;case"forethoughtWidgetResizeToMaximumValues":T();break;case"forethoughtWidgetViewImage":e.data.open?(i.isViewingImage=!0,b(h)):(i.isViewingImage=!1,q())}})),null===(e=window.visualViewport)||void 0===e||e.addEventListener("scroll",(()=>{_({event:"forethoughtSetVisualViewport",payload:M()})})),window.Forethought=(e,t,n)=>{if("widget"===e){if("open"===t&&_({action:"openWidget",mechanism:"js-api-widget-open"}),"close"===t&&_({action:"closeWidget"}),"hide"===t&&W(),"show"===t&&L(),"triggerEventComplete"===t){const e=null===n||void 0===n?void 0:n.identifier,i=(null===n||void 0===n?void 0:n.payload)||{};e?_({event:t,identifier:e,payload:i}):console.error("TRIGGER EVENT ERROR - event name is required at data.identifier")}var i;if("clearLocalData"===t&&_({action:"clearLocalData"}),"launchQuery"===t)"string"!==typeof(null===n||void 0===n||null===(i=n.payload)||void 0===i?void 0:i.query)?console.error("LAUNCH QUERY ERROR - data param must be initial query string"):n.payload.query.trim()?_({action:"launchQuery",payload:n.payload}):console.error("LAUNCH QUERY ERROR - data param must contain non whitespace characters");"showProactivePrompt"===t&&_({action:"showProactivePrompt"}),"hideProactivePrompt"===t&&_({action:"hideProactivePrompt"})}},R(),U()},f=function(){try{return new URL(window.location.origin).origin}catch{return""}};"complete"===t.readyState||"interactive"===t.readyState?h():t.addEventListener("DOMContentLoaded",h)}()})()})();
//# sourceMappingURL=embed.js.map