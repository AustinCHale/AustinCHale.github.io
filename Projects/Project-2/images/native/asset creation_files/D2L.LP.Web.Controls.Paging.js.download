D2L.Control.Paging=D2L.Control.extend({Construct:function(){arguments.callee.$.Construct.call(this);this.m_totalObjectCount=0;this.m_totalObjectCountChangeEvent=new D2L.EventHandler();this.m_pageNumber=1;this.m_pageSize=20;this.m_pageSizeLimitLower=10;this.m_pageSizeLimit=200;this.m_pageSizeChangeEvent=new D2L.EventHandler();this.m_pageNumberChangeEvent=new D2L.EventHandler();this.m_renderEvent=new D2L.EventHandler();this.m_resetEvent=new D2L.EventHandler();},BuildDom:function(){arguments.callee.$.BuildDom.call(this);this.SetDomNode(this.CreateElement('span'));this.RenderEvent().Trigger();},GetPageNumber:function(){return this.m_pageNumber;},GetState:function(serializer){serializer.AddMember('PageNumber',this.GetPageNumber());serializer.AddMember('PageSize',this.GetPageSize());},GetTotalObjectCount:function(){return this.m_totalObjectCount;},GetPageSize:function(){return this.m_pageSize;},GetPageSizeLimit:function(){return this.m_pageSizeLimit;},GetPageSizeLimitLower:function(){return this.m_pageSizeLimitLower;},IntegrateControl:function(deserializer){arguments.callee.$.IntegrateControl.call(this,deserializer);this.m_pageNumber=deserializer.GetMember('PageNumber');this.m_pageSize=deserializer.GetMember('PageSize');this.m_pageSizeLimit=deserializer.GetMember('PageSizeLimit');this.m_pageSizeLimitLower=deserializer.GetMember('PageSizeLimitLower');this.m_totalObjectCount=deserializer.GetMember('TotalObjectCount');var renderer=new D2L.Control.Paging.NumericRenderer(this);this.RenderEvent().Trigger();},TotalObjectCountChangeEvent:function(){return this.m_totalObjectCountChangeEvent;},PageNumberChangeEvent:function(){return this.m_pageNumberChangeEvent;},PageSizeChangeEvent:function(){return this.m_pageSizeChangeEvent;},RenderEvent:function(){return this.m_renderEvent;},Reset:function(){this.SetPageNumber(1,false);this.ResetEvent().Trigger();},ResetEvent:function(){return this.m_resetEvent;},SetTotalObjectCount:function(totalObjectCount){if(totalObjectCount==this.m_totalObjectCount){return;}this.m_totalObjectCount=totalObjectCount;this.TotalObjectCountChangeEvent().Trigger(totalObjectCount);},SetPageSize:function(pageSize,doTriggerEvent){if(doTriggerEvent===undefined){doTriggerEvent=true;}if(pageSize===this.m_pageSize){return;}this.m_pageSize=pageSize;this.Reset();if(doTriggerEvent){this.PageSizeChangeEvent().Trigger(pageSize);}},SetPageSizeLimit:function(pageSizeLimit){this.m_pageSizeLimit=pageSizeLimit;},SetPageNumber:function(pageNumber,doTriggerEvent){if(doTriggerEvent===undefined){doTriggerEvent=true;}if(pageNumber===this.m_pageNumber){return;}this.m_pageNumber=pageNumber;if(doTriggerEvent){this.PageNumberChangeEvent().Trigger(pageNumber);}}});D2L.Control.Paging.NumericRenderer=D2L.Class.extend({Construct:function(paging){arguments.callee.$.Construct.call(this);this.m_hasPageSize=true;this.m_pageSizes=[1,5,10,20,50,100,200];this.m_paging=paging;this.m_yuiPaginator=null;this.Init();},HasPageSize:function(){return this.m_hasPageSize;},Init:function(){var me=this;this.m_paging.TotalObjectCountChangeEvent().RegisterMethod(function(objectCount){if(me.m_yuiPaginator!==null){me.m_yuiPaginator.setTotalRecords(objectCount,true);}});this.m_paging.PageSizeChangeEvent().RegisterMethod(function(pageSize){if(me.m_yuiPaginator!==null){me.m_yuiPaginator.setRowsPerPage(pageSize,true);}});this.m_paging.PageNumberChangeEvent().RegisterMethod(function(pageNum){if(me.m_yuiPaginator!==null){me.m_yuiPaginator.setPage(pageNum,true);}});this.m_paging.ResetEvent().RegisterMethod(function(){if(me.m_yuiPaginator!==null){me.m_yuiPaginator.setPage(1,true);}});this.m_paging.RenderEvent().RegisterMethod(function(){me.Render();});},Render:function(){var id=UI.GetUniqueHtmlId();var yuiContainer=UI.CreateElement('span');yuiContainer.className='dpgn';yuiContainer.id=id;this.m_paging.GetDomNode().appendChild(yuiContainer);var lm=UI.GetLanguageManager();var strFirst=D2L.Util.Html.JsString(lm.GetPrefetchedTerm('Framework.Paging.altFirst'));var strPrev=D2L.Util.Html.JsString(lm.GetPrefetchedTerm('Framework.Paging.altPrevious'));var strNext=D2L.Util.Html.JsString(lm.GetPrefetchedTerm('Framework.Paging.altNext'));var strLast=D2L.Util.Html.JsString(lm.GetPrefetchedTerm('Framework.Paging.altLast'));var me=this;D2L.WebComponentsReady.then(function(){var configs={initialPage:me.m_paging.GetPageNumber(),rowsPerPage:me.m_paging.GetPageSize(),totalRecords:me.m_paging.GetTotalObjectCount(),containers:id,updateOnChange:true,pageLinks:5,firstPageLinkClass:'dpg_icon dpg_first',firstPageLinkLabel:'<img src=\''+D2L.LP.Web.UI.Html.Cdn.GetBaseLocation()+'img/pixel.gif\' alt=\''+strFirst+'\' title=\''+strFirst+'\' />',previousPageLinkClass:'dpg_icon dpg_prev',previousPageLinkLabel:'<img src=\''+D2L.LP.Web.UI.Html.Cdn.GetBaseLocation()+'img/pixel.gif\' alt=\''+strPrev+'\' title=\''+strPrev+'\' />',nextPageLinkClass:'dpg_icon dpg_next',nextPageLinkLabel:'<img src=\''+D2L.LP.Web.UI.Html.Cdn.GetBaseLocation()+'img/pixel.gif\' alt=\''+strNext+'\' title=\''+strNext+'\' />',lastPageLinkClass:'dpg_icon dpg_last',lastPageLinkLabel:'<img src=\''+D2L.LP.Web.UI.Html.Cdn.GetBaseLocation()+'img/pixel.gif\' alt=\''+strLast+'\' title=\''+strLast+'\' />',template:'{FirstPageLink}{PreviousPageLink}{PageLinks}{NextPageLink}{LastPageLink}',pageLabelBuilder:function(page,paginator){return D2L.Util.Integer.Format(page);}};me.m_yuiPaginator=new YAHOO.widget.Paginator(configs);me.m_yuiPaginator.subscribe('pageChange',function(event){me.m_paging.SetPageNumber(event.newValue);});me.m_yuiPaginator.render();},0);this.RenderPageSize();},RenderPageSize:function(){if(!this.HasPageSize()){return;}var me=this;var domNode=this.m_paging.GetDomNode();var container=UI.CreateElement('span');container.style.paddingLeft='1em';domNode.appendChild(container);var sl=new D2L.Control.SelectList();sl.SetTitle(new D2L.LP.Text.LangTerm('Framework.Paging.altPageSize'));sl.SetOnChange(function(){me.m_paging.SetPageSize(sl.GetSelectedKey());});for(var i=0;i<this.m_pageSizes.length;i++){var size=this.m_pageSizes[i];if(size>this.m_paging.GetPageSizeLimit()){break;}if(size>=this.m_paging.GetPageSizeLimitLower()){sl.AppendChild(new D2L.Control.SelectOption(size,size,size.toString()));}}sl.SelectOptionByKey(this.m_paging.GetPageSize(),false);sl.AppendTo(container);},SetHasPageSize:function(hasPageSize){this.m_hasPageSize=hasPageSize;}});